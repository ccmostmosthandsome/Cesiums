!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("Cesium")):"function"==typeof define&&define.amd?define(["Cesium"],e):"object"==typeof exports?exports.Cesiums=e(require("Cesium")):t.Cesiums=e(t.Cesium)}(window,function(i){return function(i){var n={};function o(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}return o.m=i,o.c=n,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(i,n,function(t){return e[t]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/dist",o(o.s=5)}([function(t,e){t.exports=i},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChoiceHelper=e.DrawHelper=e.EditableEntity=e.DazzlingLabelEntity=e.eventSystem=e.Cartesian3s=e.Cameras=void 0;var n=i(6);Object.defineProperty(e,"Cameras",{enumerable:!0,get:function(){return n.Cameras}});var o=i(2);Object.defineProperty(e,"Cartesian3s",{enumerable:!0,get:function(){return o.Cartesian3s}});var r=i(3);Object.defineProperty(e,"eventSystem",{enumerable:!0,get:function(){return r.eventSystem}});var s=i(8);Object.defineProperty(e,"DazzlingLabelEntity",{enumerable:!0,get:function(){return s.DazzlingLabelEntity}});var a=i(10);Object.defineProperty(e,"EditableEntity",{enumerable:!0,get:function(){return a.EditableEntity}});var l=i(11);Object.defineProperty(e,"ChoiceHelper",{enumerable:!0,get:function(){return l.ChoiceHelper}}),i(12);var c=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(i(13));i(15);e.DrawHelper=c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Cartesian3s=void 0;var o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(i(0));e.Cartesian3s=function(){function n(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n)}return o(n,null,[{key:"toRadians",value:function(t){return r.Cartographic.fromCartesian(t)}},{key:"toDegrees",value:function(t){var e=n.toRadians(t);return{height:e.height,latitude:r.Math.toDegrees(e.latitude),longitude:r.Math.toDegrees(e.longitude)}}},{key:"formatHeightPlus",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:5,i=n.toRadians(t);return r.Cartesian3.fromRadians(i.longitude,i.latitude,i.height+e)}},{key:"formatHeightZero",value:function(t){var e=n.toRadians(t);return r.Cartesian3.fromRadians(e.longitude,e.latitude,0)}}]),n}()},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.eventSystem=void 0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),o=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(i(0)),r=i(4),s=i(7);var a=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:3;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this._init=!1,this._accuracy=t}return n(e,[{key:"setView",value:function(t){return this._init||(this.viewer=t,(0,r.defined)(t)&&(this._init=!0,this.eventBind())),this}},{key:"setAccuracy",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:3;return this._accuracy=t,this}},{key:"eventBind",value:function(){var e=this,t=new o.ScreenSpaceEventHandler(this.viewer.scene.canvas);t.setInputAction(function(t){e.callPrimitiveCallback("leftClick",t.position)},o.ScreenSpaceEventType.LEFT_CLICK),t.setInputAction(function(t){e.callPrimitiveCallback("leftDoubleClick",t.position)},o.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),t.setInputAction(function(t){},o.ScreenSpaceEventType.MOUSE_MOVE),t.setInputAction(function(t){e.callPrimitiveCallback("leftUp",t.position)},o.ScreenSpaceEventType.LEFT_UP),t.setInputAction(function(t){e.callPrimitiveCallback("leftDown",t.position)},o.ScreenSpaceEventType.LEFT_DOWN)}},{key:"callPrimitiveCallback",value:function(t,e){var i=this.viewer.scene.pick(e,this._accuracy,this._accuracy);i&&i.primitive&&i.primitive[t]&&i.primitive[t](e),i&&(0,s.typeContaines)(i.id,"Entity")&&i.id[t]&&i.id[t](e)}},{key:"setListener",value:function(t,e,i){(0,r.defined)(t)&&(0,r.defined)(e)&&"function"==typeof i&&(t[e]=i)}},{key:"onLeftClick",value:function(t,e){this.setListener(t,l.LEFT_CLICK,e)}},{key:"onLeftDoubleClick",value:function(t,e){this.setListener(t,l.LEFT_DOUBLE_CLICK,e)}},{key:"onMouseMove",value:function(t,e){this.setListener(t,l.MOUSE_MOVE,e)}},{key:"onLeftUp",value:function(t,e){this.setListener(t,l.LEFT_UP,e)}},{key:"onLeftDown",value:function(t,e){this.setListener(t,l.LEFT_DOWN,e)}}]),e}(),l=Object.freeze({LEFT_CLICK:"leftClick",LEFT_DOUBLE_CLICK:"leftDoubleClick",MOUSE_MOVE:"mouseMove",LEFT_UP:"leftUp",LEFT_DOWN:"leftDown"});e.eventSystem=new a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.getWithDefault=function(t,e){return n(t)?t:e};var n=e.defined=function(t){return null!=t}},function(t,e,i){t.exports=i(1)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Cameras=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getType=e.typeContaines=e.isType=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=i(4);e.isType=function(t,e){return!("object"!==(void 0===t?"undefined":n(t))||!(0,o.defined)(t.constructor))&&t.constructor.toString().match(/^function\s*([^\s(]+)/)[1]===e},e.typeContaines=function(t,e){if("object"===(void 0===t?"undefined":n(t))&&(0,o.defined)(t.constructor)){var i=t.constructor.toString().match(/^function\s*([^\s(]+)/);if((0,o.defined)(i)&&(0,o.defined)(i[1]))return-1!==i[1].indexOf(e)}return!1},e.getType=function(t){if("object"===(void 0===t?"undefined":n(t))&&(0,o.defined)(t.constructor)){var e=t.constructor.toString().match(/^function\s*([^\s(]+)/);if((0,o.defined)(e)&&(0,o.defined)(e[1]))return e[1]}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DazzlingLabelEntity=void 0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),s=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(i(0)),a=i(2),o=i(3),l=i(9);e.DazzlingLabelEntity=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=(new l.SimpleCosBuilder).setPeriod(5).setAmplitude(-.5).setPhase(0).build(),o=s.JulianDate.now();i.ellipse={semiMajorAxis:1e3,semiMinorAxis:1e3,height:new s.CallbackProperty(function(t,e){return r.onSelected?(.5+n.calc(s.JulianDate.secondsDifference(s.JulianDate.now(),o)%5))*a.Cartesian3s.toRadians(i.position).height:a.Cartesian3s.toRadians(i.position).height/2},!1),fill:!1,outline:!0,outlineWidth:20,outlineColor:s.Color.RED,show:new s.CallbackProperty(function(t,e){return r.onSelected},!1)},i.polyline={positions:[a.Cartesian3s.formatHeightZero(i.position),i.position]};var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,i));return r.initEvent(),r.onSelected=!1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.Entity),n(e,[{key:"initEvent",value:function(){var e=this;o.eventSystem.onLeftClick(this,function(t){"function"==typeof e.onClickCallback&&e.onClickCallback(t)})}},{key:"onClick",value:function(t){this.onClickCallback=t}},{key:"setSelected",value:function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.onSelected=t}},{key:"cancelSelected",value:function(){this.onSelected=!1}}]),e}()},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}();function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=e.SimpleSin=function(){function n(t,e,i){return r(this,n),this.A=t,this.k=e,this.b=i,this}return o(n,[{key:"calc",value:function(t){return Math.sin(this.k*t+this.b)*this.A}}]),n}(),s=(e.SimpleSinBuilder=function(){function t(){r(this,t)}return o(t,[{key:"setPeriod",value:function(t){return this.k=2*Math.PI/t,this}},{key:"setAmplitude",value:function(t){return this.A=t,this}},{key:"setPhase",value:function(t){return this.b=t,this}},{key:"build",value:function(){return new n(this.A,this.k,this.b)}}]),t}(),e.simpleCos=function(){function n(t,e,i){return r(this,n),this.A=t,this.k=e,this.b=i,this}return o(n,[{key:"calc",value:function(t){return Math.cos(this.k*t+this.b)*this.A}}]),n}());e.SimpleCosBuilder=function(){function t(){r(this,t)}return o(t,[{key:"setPeriod",value:function(t){return this.k=2*Math.PI/t,this}},{key:"setAmplitude",value:function(t){return this.A=t,this}},{key:"setPhase",value:function(t){return this.b=t,this}},{key:"build",value:function(){return new s(this.A,this.k,this.b)}}]),t}()},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EditableEntity=void 0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),o=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(i(0));e.EditableEntity=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Entity),n(e,[{key:"test",value:function(){console.log("test")}}],[{key:"test2",value:function(){console.log("test2")}}]),e}()},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChoiceHelper=n;var u=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(i(0)),d=i(1);function n(t){this._cesiumViewer=t.viewer,this.util=new h(this._cesiumViewer),this._scene=this._cesiumViewer.scene,this._drawHelper=new d.DrawHelper(this._cesiumViewer),this._option=t,this._afterClick=t.callbacks.afterClick,this._primitives=[];var e,i,n,o,r,s,a,l=this;if(u.defined(t.toolbar)&&u.defined(t.toolbar.container))this._toolbarContainer=t.toolbar.container,this._toolbar=this._drawHelper.addToolbar(this._toolbarContainer,{buttons:t.toolbar.buttons,clickCallback:function(t){l._afterClick&&l._afterClick(),l.util.getWithDefault(l._primitives,[]).forEach(function(t,e){l._scene.primitives.remove(t)})},pickStrategy:p});else{if(!u.defined(t.dom))return void console.error("传入参数有误！");this._toolbar=this._drawHelper.addToolbar(document.body,{buttons:[]});var c=this._toolbar;t.dom.polygon&&(a=t.dom.polygon.onclick,t.dom.polygon.onclick=function(t){a&&a(t),l._afterClick&&l._afterClick(),l._drawHelper.startDrawingPolygon({callback:function(t,e){c.executeListeners({name:"polygonCreated",positions:t})},strategy:{pickStrategy:p}})}),t.dom.polygon&&(s=t.dom.polyline.onclick,t.dom.polyline.onclick=function(t){s&&s(t),l._afterClick&&l._afterClick(),l._drawHelper.startDrawingPolyline({callback:function(t,e){c.executeListeners({name:"polylineCreated",positions:t})},strategy:{pickStrategy:p}})}),t.dom.marker&&(r=t.dom.marker.onclick,t.dom.marker.onclick=function(t){r&&r(t),l._afterClick&&l._afterClick(),l._drawHelper.startDrawingMarker({callback:function(t,e){c.executeListeners({name:"markerCreated",position:t})},strategy:{pickStrategy:p}})}),t.dom.extent&&(o=t.dom.extent.onclick,t.dom.extent.onclick=function(t){o&&o(t),l._afterClick&&l._afterClick(),l._drawHelper.startDrawingExtent({callback:function(t,e){c.executeListeners({name:"extentCreated",extent:t})},strategy:{pickStrategy:p}})}),t.dom.circle&&(n=t.dom.circle.onclick,t.dom.circle.onclick=function(t){n&&n(t),l._afterClick&&l._afterClick(),l._drawHelper.startDrawingCircle({callback:function(t,e,i){c.executeListeners({name:"circleCreated",center:t,radius:e})},strategy:{pickStrategy:p}})}),t.dom.clear&&(i=t.dom.clear.onclick,t.dom.clear.onclick=function(t){i&&i(t),l._afterClick&&l._afterClick()}),t.dom.cancel&&(e=t.dom.cancel.onclick,t.dom.cancel.onclick=function(t){e&&e(t),l._afterClick&&l._afterClick(),l._drawHelper.stopDrawing()})}this._eventInit()}var p=function(t,e){if(u.defined(e.scene.pick(t))&&e.scene.pickPositionSupported)return e.scene.pickPosition(t);var i=u.Cartographic.fromCartesian(e.scene.camera.pickEllipsoid(t));return u.Cartesian3.fromRadians(i.longitude,i.latitude,0)};function h(t){this._viewer=t,this._ellipsoid=this._viewer.scene.globe._ellipsoid}n.prototype._optionReload=function(){},n.prototype._eventInit=function(){var s=this;s._toolbar.addListener("polygonCreated",function(t){new d.DrawHelper.PolygonPrimitive({positions:t.positions,material:u.Material.fromType("Checkerboard")});console.log(t);var o=[];s.util.getWithDefault(t.positions,[]).forEach(function(t,e){o.push(s.util.Cartesian3ToLatLng(t))}),s._filterExecuter(function(t){var n=[];return s.util.getWithDefault(t,[]).forEach(function(t,e){var i=u.Cartographic.fromCartesian(t.position.getValue(0));s.util._isInPolygon(i,o)&&n.push(t)}),n})}),s._toolbar.addListener("circleCreated",function(r){s._filterExecuter(function(t){var o=[];return s.util.getWithDefault(t,[]).forEach(function(t,e){var i=u.Cartographic.fromCartesian(t.position.getValue(0)),n=u.Cartesian3.fromRadians(i.longitude,i.latitude,0);u.Cartesian3.distance(s.util.getCesiumHightZero(r.center),n)<=r.radius&&o.push(t)}),o})}),s._toolbar.addListener("extentCreated",function(t){var o=t.extent;s._filterExecuter(function(t){var n=[];return s.util.getWithDefault(t,[]).forEach(function(t,e){var i=s.util.Cartesian3ToLatLng(t.position.getValue(0));o.west<=i.longitude&&o.east>=i.longitude&&o.south<=i.latitude&&o.north>=i.latitude&&n.push(t)}),n})}),s._toolbar.addListener("markerCreated",function(t){s._option.callbacks.marker(t.position)})},n.prototype.setOption=function(t){},n.prototype._callBack=function(){},n.prototype._filterExecuter=function(t){var e=this,o=t(e._cesiumViewer.entities.values);e.util.getWithDefault(e._option.callbacks.choice,[]).forEach(function(i,t){var n=[];e.util.getWithDefault(o,[]).forEach(function(t,e){i.filter(t)&&n.push(t)}),i.onChoice(n)})},h.prototype.Cartesian3ToLatLng=function(t){return this._ellipsoid.cartesianToCartographic(t)},h.prototype.Cartesian3ToDegrees=function(t){var e=this._ellipsoid.cartesianToCartographic(t);return{height:e.height,latitude:u.Math.toDegrees(e.latitude),longitude:u.Math.toDegrees(e.longitude)}},h.prototype.getWithDefault=function(t,e){return t||e},h.prototype.getCesiumHightZero=function(t){var e=u.Cartographic.fromCartesian(t);return u.Cartesian3.fromRadians(e.longitude,e.latitude,0)},h.prototype.formatHetightPlusNumber=function(t,e){var i=u.Cartographic.fromCartesian(t);return u.Cartesian3.fromRadians(i.longitude,i.latitude,i.height+e)},h.prototype._isInPolygon=function(t,e){var i,n,o=t.longitude,r=t.latitude,s=0,a=0,l=0,c=0,u=0;if(e.size<3)return!1;for(i=0,n=e.length,s=0;s<n-1;s++)u=s===n-1?(a=e[s].longitude,c=e[s].latitude,l=e[0].longitude,e[0].latitude):(a=e[s].longitude,c=e[s].latitude,l=e[s+1].longitude,e[s+1].latitude),(c<=r&&r<u||u<=r&&r<c)&&0<Math.abs(c-u)&&a-(a-l)*(c-r)/(c-u)<o&&i++;return i%2!=0}},function(t,e,i){},function(t,a,l){"use strict";(function(t){var e,i,n,o,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}window,o=function(y){var v=y.Ellipsoid.WGS84,l=function(t,e){return e.scene.camera.pickEllipsoid(t)};function m(t){var e,i;this._viewer=t,this._scene=t.scene,this._tooltip=(e=t.container,(i=function(t){var e=document.createElement("DIV");e.className="twipsy right";var i=document.createElement("DIV");i.className="twipsy-arrow",e.appendChild(i);var n=document.createElement("DIV");n.className="twipsy-inner",e.appendChild(n),this._div=e,this._title=n,t.appendChild(e),this.addEvent(),this.setVisible(!1)}).prototype.setVisible=function(t){this._div.style.display=t?"block":"none"},i.prototype.showAt=function(t,e){t&&e&&(this.setVisible(!0),this._title.innerHTML=e)},i.prototype.show=function(t){t&&(this.setVisible(!0),this._title.innerHTML=t)},i.prototype.addEvent=function(){var e=this,i=0;document.body.addEventListener("mousemove",function(t){"block"===e._div.style.display&&0==(i=i++%3)&&(e._div.style.left=t.offsetX+20+"px",e._div.style.top=t.offsetY-e._div.clientHeight/2+"px")})},new i(e)),this._surfaces=[],y.defined(y.ContextLimits)&&(y.ContextLimits._maximumAliasedLineWidth=10),this.initialiseHandlers(),this.enhancePrimitives(),w(this)}m.prototype.initialiseHandlers=function(){var i,n=this._scene,o=this,t=new y.ScreenSpaceEventHandler(n.canvas);function e(t,e){if(1!=o._handlersMuted){var i=n.pick(e);i&&i.primitive&&i.primitive[t]&&i.primitive[t](e),i&&i.id&&"Entity"===i.id.constructor.toString().match(/^function\s*([^\s(]+)/)[1]&&i.id[t]&&i.id[t](e)}}t.setInputAction(function(t){e("leftClick",t.position)},y.ScreenSpaceEventType.LEFT_CLICK),t.setInputAction(function(t){e("leftDoubleClick",t.position)},y.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),t.setInputAction(function(t){if(1!=o._handlersMuted){var e=n.pick(t.endPosition);!i||e&&i==e.primitive||((!i.isDestroyed||!i.isDestroyed())&&i.mouseOut(t.endPosition),i=null),e&&e.primitive&&((e=e.primitive).mouseOut&&(i=e),e.mouseMove&&e.mouseMove(t.endPosition))}},y.ScreenSpaceEventType.MOUSE_MOVE),t.setInputAction(function(t){e("leftUp",t.position)},y.ScreenSpaceEventType.LEFT_UP),t.setInputAction(function(t){e("leftDown",t.position)},y.ScreenSpaceEventType.LEFT_DOWN)},m.prototype.setListener=function(t,e,i){t[e]=i},m.prototype.muteHandlers=function(t){this._handlersMuted=t},m.prototype.registerEditableShape=function(e){var i=this;E(e,"mouseMove",function(t){e.setHighlighted(!0),e._editMode||i._tooltip.showAt(t,"Click to edit this shape")}),E(e,"mouseOut",function(t){e.setHighlighted(!1),i._tooltip.setVisible(!1)}),E(e,"leftClick",function(t){e.setEditMode(!0)})},m.prototype.startDrawing=function(t){this.disableAllEditMode(),this.editCleanUp&&this.editCleanUp(),this.editCleanUp=t,this.muteHandlers(!0)},m.prototype.stopDrawing=function(){this.editCleanUp&&(this.editCleanUp(),this.editCleanUp=null),this.muteHandlers(!1)},m.prototype.disableAllHighlights=function(){this.setHighlighted(void 0)},m.prototype.setHighlighted=function(t){this._highlightedSurface&&!this._highlightedSurface.isDestroyed()&&this._highlightedSurface!=t&&this._highlightedSurface.setHighlighted(!1),this._highlightedSurface=t},m.prototype.disableAllEditMode=function(){this.setEdited(void 0)},m.prototype.setEdited=function(t){this._editedSurface&&!this._editedSurface.isDestroyed()&&this._editedSurface.setEditMode(!1),this._editedSurface=t};var t=y.Material.fromType(y.Material.ColorType);t.uniforms.color=new y.Color(1,1,0,.5);var e={ellipsoid:y.Ellipsoid.WGS84,textureRotationAngle:0,height:0,asynchronous:!0,show:!0,debugShowBoundingVolume:!1,strategy:{pickStrategy:l}},p=k(e,{appearance:new y.EllipsoidSurfaceAppearance({aboveGround:!1}),material:t,granularity:Math.PI/180,strategy:{pickStrategy:l}}),c=k(e,{}),u=k(e,{}),d=k(e,{}),i=k(p,{rotation:0}),h=k(e,{width:5,geodesic:!0,granularity:1e4,appearance:new y.PolylineMaterialAppearance({aboveGround:!1}),material:t}),n=function(){function t(){}return t.prototype.initialiseOptions=function(t){g(this,t),this._ellipsoid=void 0,this._granularity=void 0,this._height=void 0,this._textureRotationAngle=void 0,this._id=void 0,this._createPrimitive=!0,this._primitive=void 0,this._outlinePolygon=void 0},t.prototype.setAttribute=function(t,e){this[t]=e,this._createPrimitive=!0},t.prototype.getAttribute=function(t){return this[t]},t.prototype.update=function(t,e,i){if(!y.defined(this.ellipsoid))throw new y.DeveloperError("this.ellipsoid must be defined.");if(!y.defined(this.appearance))throw new y.DeveloperError("this.material must be defined.");if(this.granularity<0)throw new y.DeveloperError("this.granularity and scene2D/scene3D overrides must be greater than zero.");if(this.show&&(this._createPrimitive||y.defined(this._primitive))){if(this._createPrimitive||this._ellipsoid!==this.ellipsoid||this._granularity!==this.granularity||this._height!==this.height||this._textureRotationAngle!==this.textureRotationAngle||this._id!==this.id){var n=this.getGeometry();if(!n)return;this._createPrimitive=!1,this._ellipsoid=this.ellipsoid,this._granularity=this.granularity,this._height=this.height,this._textureRotationAngle=this.textureRotationAngle,this._id=this.id,this._primitive=this._primitive&&this._primitive.destroy();this._primitive=new y.Primitive({geometryInstances:new y.GeometryInstance({geometry:n,id:this.id,pickPrimitive:this}),appearance:this.appearance,asynchronous:this.asynchronous}),this._outlinePolygon=this._outlinePolygon&&this._outlinePolygon.destroy(),this.strokeColor&&this.getOutlineGeometry&&(this._outlinePolygon=new y.Primitive({geometryInstances:new y.GeometryInstance({geometry:this.getOutlineGeometry(),attributes:{color:y.ColorGeometryInstanceAttribute.fromColor(this.strokeColor)}}),appearance:new y.PerInstanceColorAppearance({flat:!0,renderState:{depthTest:{enabled:!0},lineWidth:Math.min(this.strokeWidth||4)}})}))}var o=this._primitive;o.appearance.material=this.material,o.update(t,e,i),this._outlinePolygon&&this._outlinePolygon.update(t,e,i)}},t.prototype.isDestroyed=function(){return!1},t.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),y.destroyObject(this)},t.prototype.setStrokeStyle=function(t,e){this.strokeColor&&this.strokeColor.equals(t)&&this.strokeWidth==e||(this._createPrimitive=!0,this.strokeColor=t,this.strokeWidth=e)},t}();m.ExtentPrimitive=function(){function t(t){if(!y.defined(t.extent))throw new y.DeveloperError("Extent is required");t=k(t,p),this.initialiseOptions(t),this.setExtent(t.extent)}return(t.prototype=new n).setExtent=function(t){this.setAttribute("extent",t)},t.prototype.getExtent=function(){return this.getAttribute("extent")},t.prototype.getGeometry=function(){if(y.defined(this.extent))return new y.RectangleGeometry({rectangle:this.extent,height:this.height,vertexFormat:y.EllipsoidSurfaceAppearance.VERTEX_FORMAT,stRotation:this.textureRotationAngle,ellipsoid:this.ellipsoid,granularity:this.granularity})},t.prototype.getOutlineGeometry=function(){return new y.RectangleOutlineGeometry({rectangle:this.extent})},t}(),m.PolygonPrimitive=function(){function t(t){t=k(t,p),this.initialiseOptions(t),this.isPolygon=!0}return(t.prototype=new n).setPositions=function(t){this.setAttribute("positions",t)},t.prototype.getPositions=function(){return this.getAttribute("positions")},t.prototype.getGeometry=function(){if(y.defined(this.positions)&&!(this.positions.length<3))return y.PolygonGeometry.fromPositions({positions:this.positions,height:this.height,vertexFormat:y.EllipsoidSurfaceAppearance.VERTEX_FORMAT,stRotation:this.textureRotationAngle,ellipsoid:this.ellipsoid,granularity:this.granularity})},t.prototype.getOutlineGeometry=function(){return y.PolygonOutlineGeometry.fromPositions({positions:this.getPositions()})},t}(),m.CirclePrimitive=function(){function t(t){if(!y.defined(t.center)||!y.defined(t.radius))throw new y.DeveloperError("Center and radius are required");t=k(t,p),this.initialiseOptions(t),this.setRadius(t.radius)}return(t.prototype=new n).setCenter=function(t){this.setAttribute("center",t)},t.prototype.setRadius=function(t){this.setAttribute("radius",Math.max(.1,t))},t.prototype.getCenter=function(){return this.getAttribute("center")},t.prototype.getRadius=function(){return this.getAttribute("radius")},t.prototype.getGeometry=function(){if(y.defined(this.center)&&y.defined(this.radius))return new y.CircleGeometry({center:this.center,radius:this.radius,height:this.height,vertexFormat:y.EllipsoidSurfaceAppearance.VERTEX_FORMAT,stRotation:this.textureRotationAngle,ellipsoid:this.ellipsoid,granularity:this.granularity})},t.prototype.getOutlineGeometry=function(){return new y.CircleOutlineGeometry({center:this.getCenter(),radius:this.getRadius()})},t}(),m.EllipsePrimitive=function(){function t(t){if(!(y.defined(t.center)&&y.defined(t.semiMajorAxis)&&y.defined(t.semiMinorAxis)))throw new y.DeveloperError("Center and semi major and semi minor axis are required");t=k(t,i),this.initialiseOptions(t)}return(t.prototype=new n).setCenter=function(t){this.setAttribute("center",t)},t.prototype.setSemiMajorAxis=function(t){t<this.getSemiMinorAxis()||this.setAttribute("semiMajorAxis",t)},t.prototype.setSemiMinorAxis=function(t){t>this.getSemiMajorAxis()||this.setAttribute("semiMinorAxis",t)},t.prototype.setRotation=function(t){return this.setAttribute("rotation",t)},t.prototype.getCenter=function(){return this.getAttribute("center")},t.prototype.getSemiMajorAxis=function(){return this.getAttribute("semiMajorAxis")},t.prototype.getSemiMinorAxis=function(){return this.getAttribute("semiMinorAxis")},t.prototype.getRotation=function(){return this.getAttribute("rotation")},t.prototype.getGeometry=function(){var t;if(y.defined(this.center)&&y.defined(this.semiMajorAxis)&&y.defined(this.semiMinorAxis))return new y.EllipseGeometry((s(t={ellipsoid:this.ellipsoid,center:this.center,semiMajorAxis:this.semiMajorAxis,semiMinorAxis:this.semiMinorAxis,rotation:this.rotation,height:this.height,vertexFormat:y.EllipsoidSurfaceAppearance.VERTEX_FORMAT,stRotation:this.textureRotationAngle},"ellipsoid",this.ellipsoid),s(t,"granularity",this.granularity),t))},t.prototype.getOutlineGeometry=function(){return new y.EllipseOutlineGeometry({center:this.getCenter(),semiMajorAxis:this.getSemiMajorAxis(),semiMinorAxis:this.getSemiMinorAxis(),rotation:this.getRotation()})},t}(),m.PolylinePrimitive=function(){function t(t){t=k(t,h),this.initialiseOptions(t)}return(t.prototype=new n).setPositions=function(t){this.setAttribute("positions",t)},t.prototype.setWidth=function(t){this.setAttribute("width",t)},t.prototype.setGeodesic=function(t){this.setAttribute("geodesic",t)},t.prototype.getPositions=function(){return this.getAttribute("positions")},t.prototype.getWidth=function(){return this.getAttribute("width")},t.prototype.getGeodesic=function(t){return this.getAttribute("geodesic")},t.prototype.getGeometry=function(){if(y.defined(this.positions)&&!(this.positions.length<2))return new y.PolylineGeometry({positions:this.positions,height:this.height,width:this.width<1?1:this.width,vertexFormat:y.EllipsoidSurfaceAppearance.VERTEX_FORMAT,ellipsoid:this.ellipsoid})},t}();var f={iconUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAYAAACprHcmAAABbElEQVQoU2NkIAEwwtR6enqyc3Jy6jEzMyv9//+fl5GR8fPfv3/vff/+/dL27dt/gtSBFYMUcnBwePj4+ARYW1u7cHFxiX/9+vXl0aNH92zdunXDjx8/doA0gBV7eXmZ+/r6Zjo4OMR+//6dCWYbOzv7v3379i3evn379G3btp0EK3Z3d49tampq//79u/T///8Zfv36xfD792+Gf//+MbCwsDydOHFi5c6dOxeDFTs5OeV0dHT0vXr1ivXLl28Mf//+gXubjY3t9/Tp04r27ds3BazYysoqsaqqtuX7919S6IHz7dvXZzNnTqk5duzYfLBiY2NjG2dnt2w7O9ewf//+wd38/z/Dv717t686evTA1LNnzx4BK3ZwcOB49epViKOju7+NjYsNHx+/yKdPH94cPrz3yIEDOzeKiYmtOXDgwA94OMvIyHB+//7d+v///7oMDAwCDAwMHxgZGS9zcnIeffLkyXd4OBMbiQDHU6AM+91hMQAAAABJRU5ErkJggg==",shiftX:0,shiftY:0,strategy:{pickStrategy:l}},b={iconUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAYAAACprHcmAAABbElEQVQoU2NkIAEwwtR6enqyc3Jy6jEzMyv9//+fl5GR8fPfv3/vff/+/dL27dt/gtSBFYMUcnBwePj4+ARYW1u7cHFxiX/9+vXl0aNH92zdunXDjx8/doA0gBV7eXmZ+/r6Zjo4OMR+//6dCWYbOzv7v3379i3evn379G3btp0EK3Z3d49tampq//79u/T///8Zfv36xfD792+Gf//+MbCwsDydOHFi5c6dOxeDFTs5OeV0dHT0vXr1ivXLl28Mf//+gXubjY3t9/Tp04r27ds3BazYysoqsaqqtuX7919S6IHz7dvXZzNnTqk5duzYfLBiY2NjG2dnt2w7O9ewf//+wd38/z/Dv717t686evTA1LNnzx4BK3ZwcOB49epViKOju7+NjYsNHx+/yKdPH94cPrz3yIEDOzeKiYmtOXDgwA94OMvIyHB+//7d+v///7oMDAwCDAwMHxgZGS9zcnIeffLkyXd4OBMbiQDHU6AM+91hMQAAAABJRU5ErkJggg==",shiftX:0,shiftY:0};function _(t){return v.cartographicArrayToCartesianArray([y.Rectangle.northwest(t),y.Rectangle.northeast(t),y.Rectangle.southeast(t),y.Rectangle.southwest(t)])}function C(t,e){var i=new y.Rectangle;i.west=Math.min(t.longitude,e.longitude),i.east=Math.max(t.longitude,e.longitude),i.south=Math.min(t.latitude,e.latitude),i.north=Math.max(t.latitude,e.latitude);var n=y.Math.EPSILON7;return i.east-i.west<n&&(i.east+=2*n),i.north-i.south<n&&(i.north+=2*n),i}function o(t,e){if(null==t||"object"!=(void 0===t?"undefined":r(t)))return t;if(t.constructor!=Object&&t.constructor!=Array)return t;if(t.constructor==Date||t.constructor==RegExp||t.constructor==Function||t.constructor==String||t.constructor==Number||t.constructor==Boolean)return new t.constructor(t);for(var i in e=e||new t.constructor,t)e[i]=void 0===e[i]?o(t[i],null):e[i];return e}function g(t,e){var i;for(i in t=t||{},e)void 0===t[i]&&(t[i]=o(e[i]))}function k(t,e){var i,n=o(t);for(i in e)void 0===n[i]&&(n[i]=o(e[i]));return n}function E(t,e,i){t[e]=i}function w(t){t._listeners={},t.addListener=function(t,e){return this._listeners[t]=this._listeners[t]||[],this._listeners[t].push(e),this._listeners[t].length},t.executeListeners=function(t,e){if(this._listeners[t.name]&&0<this._listeners[t.name].length)for(var i=0;i<this._listeners[t.name].length;i++)this._listeners[t.name][i](t);else e&&e(t)}}function S(t){var e=y.Cartographic.fromCartesian(t);return y.Cartesian3.fromRadians(e.longitude,e.latitude,0)}return m.prototype.createBillboardGroup=function(t,e,i){var n=new m.BillboardGroup(this,e);return n.addBillboards(t,i),n},(m.BillboardGroup=function(t,e){this._drawHelper=t,this._scene=t._scene,this._options=k(e,f);var i=new y.BillboardCollection;this._scene.primitives.add(i),this._billboards=i,this._orderedBillboards=[]}).prototype.createBillboard=function(t,n){var o=this._billboards.add({show:!0,position:t,pixelOffset:new y.Cartesian2(this._options.shiftX,this._options.shiftY),eyeOffset:new y.Cartesian3(0,0,0),horizontalOrigin:y.HorizontalOrigin.CENTER,verticalOrigin:y.VerticalOrigin.CENTER,scale:1,image:this._options.iconUrl,color:new y.Color(1,1,1,1)});if(n){var r=function(t){e.enableRotate=t},s=function(){for(var t=0,e=a._orderedBillboards.length;t<e&&a._orderedBillboards[t]!=o;++t);return t},a=this,e=this._scene.screenSpaceCameraController;if(n.dragHandlers){a=this;E(o,"leftDown",function(t){function i(t){e.destroy(),r(!0),n.dragHandlers.onDragEnd&&n.dragHandlers.onDragEnd(s(),t)}var e=new y.ScreenSpaceEventHandler(a._scene.canvas);e.setInputAction(function(t){var e=a._scene.camera.pickEllipsoid(t.endPosition,v);e?function(t){o.position=t;for(var e=0,i=a._orderedBillboards.length;e<i&&a._orderedBillboards[e]!=o;++e);n.dragHandlers.onDrag&&n.dragHandlers.onDrag(s(),t)}(e):i(e)},y.ScreenSpaceEventType.MOUSE_MOVE),e.setInputAction(function(t){i(a._scene.camera.pickEllipsoid(t.position,v))},y.ScreenSpaceEventType.LEFT_UP),r(!1),n.dragHandlers.onDragStart&&n.dragHandlers.onDragStart(s(),a._scene.camera.pickEllipsoid(t,v))})}n.onDoubleClick&&E(o,"leftDoubleClick",function(t){n.onDoubleClick(s())}),n.onClick&&E(o,"leftClick",function(t){n.onClick(s())}),n.tooltip&&(E(o,"mouseMove",function(t){a._drawHelper._tooltip.showAt(t,n.tooltip())}),E(o,"mouseOut",function(t){a._drawHelper._tooltip.setVisible(!1)}))}return o},m.BillboardGroup.prototype.insertBillboard=function(t,e,i){this._orderedBillboards.splice(t,0,this.createBillboard(e,i))},m.BillboardGroup.prototype.addBillboard=function(t,e){this._orderedBillboards.push(this.createBillboard(t,e))},m.BillboardGroup.prototype.addBillboards=function(t,e){for(var i=0;i<t.length;i++)this.addBillboard(t[i],e)},m.BillboardGroup.prototype.updateBillboardsPositions=function(t){for(var e=0;e<t.length;e++)this.getBillboard(e).position=t[e]},m.BillboardGroup.prototype.countBillboards=function(){return this._orderedBillboards.length},m.BillboardGroup.prototype.getBillboard=function(t){return this._orderedBillboards[t]},m.BillboardGroup.prototype.removeBillboard=function(t){this._billboards.remove(this.getBillboard(t)),this._orderedBillboards.splice(t,1)},m.BillboardGroup.prototype.remove=function(){this._billboards=this._billboards&&this._billboards.removeAll()&&this._billboards.destroy()},m.BillboardGroup.prototype.setOnTop=function(){this._scene.primitives.raiseToTop(this._billboards)},m.prototype.startDrawingMarker=function(r){r=k(r,f);this.startDrawing(function(){n&&n.remove(),e&&e.destroy(),a&&a.setVisible(!1)});var i=this,t=this._scene,s=this._viewer,a=(t.primitives,this._tooltip),n=new m.BillboardGroup(this,r),e=new y.ScreenSpaceEventHandler(t.canvas);e.setInputAction(function(t){if(null!=t.position){var e=r.strategy.pickStrategy(t.position,s);e&&(n.addBillboard(e),i.stopDrawing(),r.callback(e,i))}},y.ScreenSpaceEventType.LEFT_CLICK),e.setInputAction(function(t){var e,i,n=t.endPosition;if(null!=n){var o=r.strategy.pickStrategy(n,s);o?a.showAt(n,"<p>Click to add your marker. Position is: </p>"+((e=v.cartesianToCartographic(o)).longitude.toFixed(i||3)+", "+e.latitude.toFixed(i||3))):a.showAt(n,"<p>Click on the globe to add your marker.</p>")}},y.ScreenSpaceEventType.MOUSE_MOVE)},m.prototype.startDrawingPolygon=function(t){this.startDrawingPolyshape(!0,t)},m.prototype.startDrawingPolyline=function(t){this.startDrawingPolyshape(!1,t)},m.prototype.startDrawingPolyshape=function(t,n){n=k(n,t?p:h),this.startDrawing(function(){s&&s.remove(o),u&&u.remove(),d&&d.destroy(),a&&a.setVisible(!1)});var o,e=this,i=this._scene,r=this._viewer,s=i.primitives,a=this._tooltip,l=t?3:2;(o=t?new m.PolygonPrimitive(n):new m.PolylinePrimitive(n)).asynchronous=!1,s.add(o);var c=[],u=new m.BillboardGroup(this,f),d=new y.ScreenSpaceEventHandler(i.canvas);d.setInputAction(function(t){if(null!=t.position){if(c.length<l)return;if(n.strategy.pickStrategy(t.position,r)&&(e.stopDrawing(),"function"==typeof n.callback)){c.length;n.callback(c,e)}}},y.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),d.setInputAction(function(t){var e=n.strategy.pickStrategy(t.position,r);e=S(e),null!=t.position&&e&&(0==c.length&&(c.push(e.clone()),u.addBillboard(c[0])),c.length>=l&&(o.positions=c,o._createPrimitive=!0),c.push(e),u.addBillboard(e))},y.ScreenSpaceEventType.LEFT_CLICK),d.setInputAction(function(t){var e=t.endPosition;if(null!=e)if(0==c.length)a.showAt(e,"<p>Click to add first point</p>");else{var i=n.strategy.pickStrategy(e,r);i&&(c.pop(),i.y+=y.Math.EPSILON7,c.push(i),c.length>=l&&(o.positions=c,o._createPrimitive=!0),u.getBillboard(c.length-1).position=i,a.showAt(e,"<p>Click to add new point ("+c.length+")</p>"+(c.length>l?"<p>Double click to finish drawing</p>":"")))}},y.ScreenSpaceEventType.MOUSE_MOVE)},m.prototype.startDrawingExtent=function(n){n=k(n,p);this.startDrawing(function(){null!=l&&r&&r.remove(l),c&&c.remove(),e&&e.destroy(),s&&s.setVisible(!1)});var i=this,t=this._scene,o=this._viewer,r=this._scene.primitives,s=this._tooltip,a=null,l=null,c=null,e=new y.ScreenSpaceEventHandler(t.canvas);function u(t){null==l&&((l=new m.ExtentPrimitive({extent:t,material:n.material})).asynchronous=!1,r.add(l)),l.setExtent(t);var e=_(l.rectangle=t);null==c?(c=new m.BillboardGroup(i,f)).addBillboards(e):c.updateBillboardsPositions(e)}e.setInputAction(function(t){if(null!=t.position){var e=n.strategy.pickStrategy(t.position,o);if(e)if(null==l)u(C(a=v.cartesianToCartographic(e),a));else i.stopDrawing(),"function"==typeof n.callback&&n.callback(C(a,v.cartesianToCartographic(e)))}},y.ScreenSpaceEventType.LEFT_DOWN),e.setInputAction(function(t){var e=t.endPosition;if(null!=e)if(null==l)s.showAt(e,"<p>Click to start drawing rectangle</p>");else{var i=n.strategy.pickStrategy(e,o);if(i)u(C(a,v.cartesianToCartographic(i))),s.showAt(e,"<p>Drag to change rectangle extent</p><p>Click again to finish drawing</p>")}},y.ScreenSpaceEventType.MOUSE_MOVE)},m.prototype.startDrawingCircle=function(n){n=k(n,p);this.startDrawing(function(){null!=a&&r&&r.remove(a),l&&l.remove(),e&&e.destroy(),s&&s.setVisible(!1)});var i=this,t=this._scene,o=this._viewer,r=this._scene.primitives,s=this._tooltip,a=null,l=null,e=new y.ScreenSpaceEventHandler(t.canvas);e.setInputAction(function(t){if(null!=t.position){var e=n.strategy.pickStrategy(t.position,o);e&&(null==a?(a=new m.CirclePrimitive({center:e,radius:0,asynchronous:!1,material:n.material}),r.add(a),(l=new m.BillboardGroup(i,f)).addBillboards([e])):("function"==typeof n.callback&&n.callback(a.getCenter(),a.getRadius(),i),i.stopDrawing()))}},y.ScreenSpaceEventType.LEFT_DOWN),e.setInputAction(function(t){var e=t.endPosition;if(null!=e)if(null==a)s.showAt(e,"<p>Click to start drawing the circle</p>");else{var i=n.strategy.pickStrategy(e,o);i&&(a.setRadius(y.Cartesian3.distance(S(a.getCenter()),S(i))),l.updateBillboardsPositions(i),s.showAt(e,"<p>Move mouse to change circle radius</p><p>Click again to finish drawing</p>"))}},y.ScreenSpaceEventType.MOUSE_MOVE)},m.prototype.enhancePrimitives=function(){var g=this;function e(t){g._scene;this._highlighted&&this._highlighted==t||!0!==this._editMode&&((this._highlighted=t)?(g.setHighlighted(this),this._strokeColor=this.strokeColor,this.setStrokeStyle(y.Color.fromCssColorString("white"),this.strokeWidth)):this._strokeColor?this.setStrokeStyle(this._strokeColor,this.strokeWidth):this.setStrokeStyle(void 0,void 0))}function i(t){if(this._editMode!=t)if(g.disableAllHighlights(),t){g.setEdited(this);var i=g._scene,n=this;if(null==this._markers){var o=function(t,e){var i=t-1<0?e.length-1:t-1;i<c.countBillboards()&&(c.getBillboard(i).position=s(i)),(i=t)<c.countBillboards()&&(c.getBillboard(i).position=s(i))},r=function(){n.executeListeners({name:"onEdited",positions:n.positions})},s=function(t){var e=n.positions;return v.cartographicToCartesian(new y.EllipsoidGeodesic(v.cartesianToCartographic(e[t]),v.cartesianToCartographic(e[t<e.length-1?t+1:0])).interpolateUsingFraction(.5))},e=this.dragBillboard?this.dragBillboard:b,a=this.dragHalfBillboard?this.dragHalfBillboard:b,l=new m.BillboardGroup(g,e),c=new m.BillboardGroup(g,a),u={dragHandlers:{onDrag:function(t,e){n.positions[t]=e,o(t,n.positions),n._createPrimitive=!0},onDragEnd:function(t,e){n._createPrimitive=!0,r()}},onDoubleClick:function(t){n.positions.length<4||(n.positions.splice(t,1),n._createPrimitive=!0,l.removeBillboard(t),c.removeBillboard(t),o(t,n.positions),r())},tooltip:function(){if(3<n.positions.length)return"Double click to remove this point"}};l.addBillboards(n.positions,u),this._markers=l;for(var d=[],p=0,h=n.positions.length+(this.isPolygon?0:-1);p<h;p++)d.push(s(p));var f={dragHandlers:{onDragStart:function(t,e){this.index=t+1,n.positions.splice(this.index,0,e),n._createPrimitive=!0},onDrag:function(t,e){n.positions[this.index]=e,n._createPrimitive=!0},onDragEnd:function(t,e){l.insertBillboard(this.index,e,u),c.getBillboard(this.index-1).position=s(this.index-1),c.insertBillboard(this.index,s(this.index),f),n._createPrimitive=!0,r()}},tooltip:function(){return"Drag to create a new point"}};c.addBillboards(d,f),this._editMarkers=c,this._globeClickhandler=new y.ScreenSpaceEventHandler(i.canvas),this._globeClickhandler.setInputAction(function(t){var e=i.pick(t.position);e&&e.primitive||n.setEditMode(!1)},y.ScreenSpaceEventType.LEFT_CLICK),l.setOnTop(),c.setOnTop()}this._editMode=!0}else null!=this._markers&&(this._markers.remove(),this._editMarkers.remove(),this._markers=null,this._editMarkers=null,this._globeClickhandler.destroy()),this._editMode=!1}y.Billboard.prototype.setEditable=function(){if(!this._editable){this._editable=!0;var o=this,r=this;E(o,"leftDown",function(t){function n(t){e.destroy(),i(!0),r.executeListeners({name:"dragEnd",positions:t})}var e=new y.ScreenSpaceEventHandler(g._scene.canvas);e.setInputAction(function(t){var e,i=g._scene.camera.pickEllipsoid(t.endPosition,v);i?(e=i,o.position=e,r.executeListeners({name:"drag",positions:e})):n(i)},y.ScreenSpaceEventType.MOUSE_MOVE),e.setInputAction(function(t){n(g._scene.camera.pickEllipsoid(t.position,v))},y.ScreenSpaceEventType.LEFT_UP),i(!1)}),w(o)}function i(t){g._scene.screenSpaceCameraController.enableRotate=t}},y.Entity.prototype.setEditable=function(t){if(!1===t)return delete(o=this)["leftDown"],void(this._editable=!1);if("billboard"===this.modeType&&!this._editable){this._editable=!0;var o,r=this;E(o=this,"leftDown",function(t){function n(t){e.destroy(),i(!0),r.executeListeners({name:"dragEnd",positions:t})}var e=new y.ScreenSpaceEventHandler(g._scene.canvas);e.setInputAction(function(t){var e,i=g._scene.camera.pickEllipsoid(t.endPosition,v);i?(e=i,o.position=e,r.executeListeners({name:"drag",positions:e})):n(i)},y.ScreenSpaceEventType.MOUSE_MOVE),e.setInputAction(function(t){n(g._scene.camera.pickEllipsoid(t.position,v))},y.ScreenSpaceEventType.LEFT_UP),i(!1)}),w(o)}function i(t){g._scene.screenSpaceCameraController.enableRotate=t}},m.PolylinePrimitive.prototype.setEditable=function(){if(!this.setEditMode){var t=this;t.isPolygon=!1,t.asynchronous=!1,g.registerEditableShape(t),t.setEditMode=i;var e=this.width;t.setHighlighted=function(t){!0!==this._editMode&&(t?(g.setHighlighted(this),this.setWidth(2*e)):this.setWidth(e))},t.getExtent=function(){return y.Extent.fromCartographicArray(v.cartesianArrayToCartographicArray(this.positions))},w(t),t.setEditMode(!1)}},m.PolygonPrimitive.prototype.setEditable=function(){var t=this;t.asynchronous=!1;g._scene;g.registerEditableShape(t),t.setEditMode=i,t.setHighlighted=e,w(t),t.setEditMode(!1)},m.ExtentPrimitive.prototype.setEditable=function(){if(!this.setEditMode){var r=this,s=g._scene;g.registerEditableShape(r),r.asynchronous=!1,r.setEditMode=function(t){if(this._editMode!=t)if(g.disableAllHighlights(),t){if(g.setEdited(this),null==this._markers){var e=this.dragBillboard?this.dragBillboard:b,i=this.dragHalfBillboard?this.dragHalfBillboard:b,n=new m.BillboardGroup(e,i),o={dragHandlers:{onDrag:function(t,e){var i=n.getBillboard((t+2)%4).position;r.setExtent(C(v.cartesianToCartographic(i),v.cartesianToCartographic(e))),n.updateBillboardsPositions(_(r.extent))},onDragEnd:function(t,e){r.executeListeners({name:"onEdited",extent:r.extent})}},tooltip:function(){return"Drag to change the corners of this extent"}};n.addBillboards(_(r.extent),o),this._markers=n,this._globeClickhandler=new y.ScreenSpaceEventHandler(s.canvas),this._globeClickhandler.setInputAction(function(t){var e=s.pick(t.position);try{e&&!e.isDestroyed()&&e.primitive||r.setEditMode(!1)}catch(t){r.setEditMode(!1)}},y.ScreenSpaceEventType.LEFT_CLICK),n.setOnTop()}this._editMode=!0}else null!=this._markers&&(this._markers.remove(),this._markers=null,this._globeClickhandler.destroy()),this._editMode=!1},r.setHighlighted=e,w(r),r.setEditMode(!1)}},m.EllipsePrimitive.prototype.setEditable=function(){if(!this.setEditMode){var s=this,a=g._scene;s.asynchronous=!1,g.registerEditableShape(s),s.setEditMode=function(t){if(this._editMode!=t)if(g.disableAllHighlights(),t){g.setEdited(this);var i=this;if(null==this._markers){var n=function(){return y.Shapes.computeEllipseBoundary(v,s.getCenter(),s.getSemiMajorAxis(),s.getSemiMinorAxis(),s.getRotation()+Math.PI/2,Math.PI/2).splice(0,4)},e=this.dragBillboard?this.dragBillboard:b,o=new m.BillboardGroup(g,e),r={dragHandlers:{onDrag:function(t,e){var i=y.Cartesian3.distance(s.getCenter(),e);t%2==0?s.setSemiMajorAxis(i):s.setSemiMinorAxis(i),o.updateBillboardsPositions(n())},onDragEnd:function(t,e){s.executeListeners({name:"onEdited",center:s.getCenter(),semiMajorAxis:s.getSemiMajorAxis(),semiMinorAxis:s.getSemiMinorAxis(),rotation:0})}},tooltip:function(){return"Drag to change the excentricity and radius"}};o.addBillboards(n(),r),this._markers=o,this._globeClickhandler=new y.ScreenSpaceEventHandler(a.canvas),this._globeClickhandler.setInputAction(function(t){var e=a.pick(t.position);e&&e.primitive||i.setEditMode(!1)},y.ScreenSpaceEventType.LEFT_CLICK),o.setOnTop()}this._editMode=!0}else null!=this._markers&&(this._markers.remove(),this._markers=null,this._globeClickhandler.destroy()),this._editMode=!1},s.setHighlighted=e,w(s),s.setEditMode(!1)}},m.CirclePrimitive.prototype.getCircleCartesianCoordinates=function(t){for(var e,i=y.CircleOutlineGeometry.createGeometry(new y.CircleOutlineGeometry({ellipsoid:v,center:this.getCenter(),radius:this.getRadius(),granularity:t})),n=0,o=[];n<i.attributes.position.values.length;n+=3)e=i.attributes.position.values,o.push(new y.Cartesian3(e[n],e[n+1],e[n+2]));return o},m.CirclePrimitive.prototype.setEditable=function(){if(!this.setEditMode){var s=this,a=g._scene;s.asynchronous=!1,g.registerEditableShape(s),s.setEditMode=function(t){if(this._editMode!=t)if(g.disableAllHighlights(),t){g.setEdited(this);var i=this;if(null==this._markers){var n=function(){return i.getCircleCartesianCoordinates(y.Math.PI_OVER_TWO)},e=this.dragBillboard?this.dragBillboard:b,o=new m.BillboardGroup(g,e),r={dragHandlers:{onDrag:function(t,e){s.setRadius(y.Cartesian3.distance(s.getCenter(),e)),o.updateBillboardsPositions(n())},onDragEnd:function(t,e){s.executeListeners({name:"onEdited",center:s.getCenter(),radius:s.getRadius()})}},tooltip:function(){return"Drag to change the radius"}};o.addBillboards(n(),r),this._markers=o,this._globeClickhandler=new y.ScreenSpaceEventHandler(a.canvas),this._globeClickhandler.setInputAction(function(t){var e=a.pick(t.position);e&&e.primitive||i.setEditMode(!1)},y.ScreenSpaceEventType.LEFT_CLICK),o.setOnTop()}this._editMode=!0}else null!=this._markers&&(this._markers.remove(),this._markers=null,this._globeClickhandler.destroy()),this._editMode=!1},s.setHighlighted=e,w(s),s.setEditMode(!1)}}},m.DrawHelperWidget=function(t,e){if(!y.defined(e.container))throw new y.DeveloperError("Container is required");var i={markerIcon:" marker",polylineIcon:" polyline",polygonIcon:" polygon",circleIcon:" circle",extentIcon:" extent",clearIcon:" clear",polylineDrawingOptions:h,polygonDrawingOptions:c,extentDrawingOptions:u,circleDrawingOptions:d,strategy:{pickStrategy:e.pickStrategy?e.pickStrategy:l}};g(e,i);var n=this,r=document.createElement("DIV");function o(t,e,i,n){var o=document.createElement("DIV");return o.className="button"+e,o.title=i,r.appendChild(o),o.onclick=n,o}r.className="toolbar",e.container.appendChild(r);var s=t._scene;-1!==e.buttons.indexOf("marker")&&o(0,e.markerIcon,"Click to start drawing a 2D marker",function(){"function"==typeof e.clickCallback&&e.clickCallback({name:"markerClick"}),t.startDrawingMarker({callback:function(t){n.executeListeners({name:"markerCreated",position:t})},strategy:e.strategy})}),-1!==e.buttons.indexOf("polyline")&&o(0,e.polylineIcon,"Click to start drawing a 2D polyline",function(){"function"==typeof e.clickCallback&&e.clickCallback({name:"polylineClick"}),t.startDrawingPolyline({callback:function(t){n.executeListeners({name:"polylineCreated",positions:t})},strategy:e.strategy})}),-1!==e.buttons.indexOf("polygon")&&o(0,e.polygonIcon,"Click to start drawing a 2D polygon",function(){"function"==typeof e.clickCallback&&e.clickCallback({name:"polygonClick"}),t.startDrawingPolygon({callback:function(t){n.executeListeners({name:"polygonCreated",positions:t})},strategy:e.strategy})}),-1!==e.buttons.indexOf("extent")&&o(0,e.extentIcon,"Click to start drawing an Extent",function(){"function"==typeof e.clickCallback&&e.clickCallback({name:"extentClick"}),t.startDrawingExtent({callback:function(t){n.executeListeners({name:"extentCreated",extent:t})},strategy:e.strategy})}),-1!==e.buttons.indexOf("circle")&&o(0,e.circleIcon,"Click to start drawing a Circle",function(){"function"==typeof e.clickCallback&&e.clickCallback({name:"circleClick"}),t.startDrawingCircle({callback:function(t,e){n.executeListeners({name:"circleCreated",center:t,radius:e})},strategy:e.strategy})});var a=document.createElement("DIV");a.className="divider",r.appendChild(a),-1!==e.buttons.indexOf("clear")&&o(0,e.clearIcon,"Remove all primitives",function(){"function"==typeof e.clickCallback&&e.clickCallback({name:"clearClick"}),s.primitives.removeAll()}),w(this)},m.prototype.addToolbar=function(t,e){return e=k(e,{container:t}),new m.DrawHelperWidget(this,e)},m},"object"===r(a)&&"object"===r(t)?t.exports=o(l(0)):(i=[l(0)],void 0===(n="function"==typeof(e=o)?e.apply(a,i):e)||(t.exports=n))}).call(this,l(14)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){}])});
//# sourceMappingURL=Cesiums.min.js.map