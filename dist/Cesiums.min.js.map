{"version":3,"sources":["webpack://[name]/webpack/universalModuleDefinition","webpack://[name]/webpack/bootstrap","webpack://[name]/external \"Cesium\"","webpack://[name]/./src/index.js","webpack://[name]/./src/Util/NormalUtils.js","webpack://[name]/./src/Util/OfficialUtils.js","webpack://[name]/./src/Core/Cartesian3s.js","webpack://[name]/./src/Core/EventSystem.js","webpack://[name]/./src/Widgets/Settings.js","webpack://[name]/./src/Scene/Cameras.js","webpack://[name]/./src/Util/TypeUtils.js","webpack://[name]/./src/ThirdParty/DrawHelperV2/util/EventHelper.js","webpack://[name]/./src/DataSources/DazzlingLabelEntity.js","webpack://[name]/./src/Util/Math.js","webpack://[name]/./src/DataSources/BaseEntity.js","webpack://[name]/./src/DataSources/EditableEntity.js","webpack://[name]/./src/Widgets/Patchs.js","webpack://[name]/./src/ThirdParty/ChoiceHelper.js","webpack://[name]/./src/ThirdParty/DrawHelper.js","webpack://[name]/(webpack)/buildin/module.js"],"names":["webpackUniversalModuleDefinition","root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__0__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","getDefault","getModuleExports","object","property","prototype","hasOwnProperty","p","s","Cameras","Cartesian3s","eventSystem","EventType","DazzlingLabelEntity","EditableEntity","Settings","cesium1_50Patch","ChoiceHelper","officialUtils","drawHelper","__dirpath","getPathDir","scriptSrc","nodeList","document","querySelectorAll","length","test","item","src","match","OfficialUtils","DrawHelper","getWithDefault","element","defaultElement","defined","computeCirclularFlight","lon","lat","height","radius","Cesium","SampledPositionProperty","startAngle","Math","nextRandomNumber","endAngle","increment","radians","toRadians","timeIncrement","time","JulianDate","addSeconds","start","position","Cartesian3","fromDegrees","cos","sin","addSample","computeCirclularFlightPositions","positions","push","computeCirclularAugle","angles","computeCircle","Cartesian2","cartesian3","Cartographic","fromCartesian","cartographic","latitude","toDegrees","longitude","heightPlus","arguments","undefined","fromRadians","_NormalUtils","_TypeUtils","_Settings","EventSystem","accuracy","_classCallCheck","this","_init","_accuracy","viewer","eventBind","_this","pressFlag","currentObject","firstFlag","handler","ScreenSpaceEventHandler","scene","canvas","setInputAction","movement","callPrimitiveCallback","LEFT_CLICK","ScreenSpaceEventType","LEFT_DOUBLE_CLICK","callPrimitiveCallbackCurrent","DRAW_START","endPosition","DRAW","MOUSE_MOVE","DRAW_END","LEFT_UP","enableRotation","LEFT_DOWN","eventName","pickedObject","pick","typeContaines","id","primitive","pickedObjectObj","obj","type","callback","setListener","freeze","cesiumWidget","screenSpaceEventHandler","removeInputAction","screenSpaceCameraController","enableTilt","enable","enableRotate","_OfficialUtils","camera","distance","totalDistance","subtract","add","multiplyByScalar","second","pitch","index","timeInterval","interval","setInterval","lookAt","HeadingPitchRange","lookAtTransform","Matrix4","IDENTITY","clearInterval","_ref","_ref$heading","heading","_ref$pitch","_ref$range","range","complete","cancel","rotationTranslation","fromRotationTranslation","Matrix3","fromHeadingPitchRoll","HeadingPitchRoll","PI","relativePosition","multiplyByPoint","earthTransform","Transforms","eastNorthUpToFixedFrame","Ellipsoid","WGS84","cameraPosition","flyTo","destination","orientation","roll","data","dataCompress","x","toFixed","y","z","encodeURIComponent","join","isFly","errorCallback","decodeURIComponent","split","target","parseFloat","setView","e","console","error","isType","instance","typeName","_typeof","constructor","toString","typeMatchGroup","indexOf","getType","removeListener","enhanceWithListeners","_listeners","addListener","executeListeners","event","defaultCallback","_Cartesian3s","_Math","_BaseEntity2","_index","config","_ref$modelColor","modelColor","Color","DARKVIOLET","_ref$line","line","_ref$line$width","width","_ref$ring","ring","_ref$ring$timePeriod","timePeriod","_ref$ring$relativeSiz","relativeSize","_possibleConstructorReturn","__proto__","getPrototypeOf","simpleCos","SimpleCosBuilder","setPeriod","setAmplitude","setPhase","build","startTime","now","ringEntity","Entity","CallbackProperty","result","formatHeight","calc","secondsDifference","model","uri","scale","maximumScale","color","show","selected","polyline","formatHeightZero","material","parent","initEvent","BaseEntity","entities","SimpleSin","A","k","b","_createClass","SimpleSinBuilder","number","_EventSystem","remove","_selectedCallback","_releaseCallback","_this2","onLeftClick","onClickCallback","_selected","log","defineProperties","Model","_cachedGltf","set","_vtxf_cachedGltf","_gltf","fixGltf","gltf","extensionsUsed","v","extensionsRequired","splice","extensions","programs","shaders","techniques","materials","forEach","mat","values","vtxfMaterialExtension","us","technique","uniforms","attribute","attributes","parameters","uniform","_cesiumViewer","util","Util","_scene","_drawHelper","_option","_afterClick","callbacks","afterClick","_primitives","lastOnclick","me","toolbar","container","_toolbarContainer","_toolbar","addToolbar","buttons","clickCallback","primitives","pickStrategy","dom","body","polygon","onclick","startDrawingPolygon","self","strategy","startDrawingPolyline","marker","startDrawingMarker","extent","startDrawingExtent","circle","startDrawingCircle","center","clear","stopDrawing","_eventInit","pickPositionSupported","pickPosition","pickEllipsoid","_viewer","_ellipsoid","globe","_optionReload","PolygonPrimitive","Material","fromType","LatLngPaths","Cartesian3ToLatLng","_filterExecuter","parseEntities","entity","latlng","getValue","_isInPolygon","groundPosition","getCesiumHightZero","cartesian3ToLatLng","west","east","south","north","setOption","option","_callBack","containsCallback","containEntities","choice","index2","filter","onChoice","cartesianToCartographic","Cartesian3ToDegrees","formatHetightPlusNumber","paths","isum","icount","dLon1","dLon2","dLat1","dLat2","size","abs","__WEBPACK_AMD_DEFINE_RESULT__","__WEBPACK_AMD_DEFINE_FACTORY__","apply","__WEBPACK_AMD_DEFINE_ARRAY__","ellipsoid","defaultPickStrategy","_","_tooltip","createTooltip","frameDiv","tooltip","div","createElement","className","arrow","appendChild","title","_div","_title","addEvent","setVisible","visible","style","display","showAt","message","innerHTML","count","addEventListener","ev","left","offsetX","top","offsetY","clientHeight","_surfaces","ContextLimits","_maximumAliasedLineWidth","initialiseHandlers","enhancePrimitives","mouseOutObject","_self","_handlersMuted","isDestroyed","mouseOut","mouseMove","muteHandlers","muted","registerEditableShape","surface","setHighlighted","_editMode","setEditMode","startDrawing","cleanUp","disableAllEditMode","editCleanUp","disableAllHighlights","_highlightedSurface","setEdited","_editedSurface","ColorType","defaultShapeOptions","textureRotationAngle","asynchronous","debugShowBoundingVolume","defaultSurfaceOptions","copyOptions","appearance","EllipsoidSurfaceAppearance","aboveGround","granularity","defaultPolygonOptions","defaultExtentOptions","defaultCircleOptions","defaultEllipseOptions","rotation","defaultPolylineOptions","geodesic","PolylineMaterialAppearance","ChangeablePrimitive","initialiseOptions","options","fillOptions","_granularity","_height","_textureRotationAngle","_id","_createPrimitive","_primitive","_outlinePolygon","setAttribute","getAttribute","update","context","frameState","commandList","DeveloperError","geometry","getGeometry","destroy","Primitive","geometryInstances","GeometryInstance","pickPrimitive","strokeColor","getOutlineGeometry","ColorGeometryInstanceAttribute","fromColor","PerInstanceColorAppearance","flat","renderState","depthTest","enabled","lineWidth","min","strokeWidth","destroyObject","setStrokeStyle","equals","ExtentPrimitive","setExtent","getExtent","RectangleGeometry","rectangle","vertexFormat","VERTEX_FORMAT","stRotation","RectangleOutlineGeometry","isPolygon","setPositions","getPositions","PolygonGeometry","fromPositions","PolygonOutlineGeometry","CirclePrimitive","setRadius","setCenter","max","getCenter","getRadius","CircleGeometry","CircleOutlineGeometry","EllipsePrimitive","semiMajorAxis","semiMinorAxis","setSemiMajorAxis","getSemiMinorAxis","setSemiMinorAxis","getSemiMajorAxis","setRotation","getRotation","EllipseGeometry","_defineProperty","EllipseOutlineGeometry","PolylinePrimitive","setWidth","setGeodesic","getWidth","getGeodesic","PolylineGeometry","defaultBillboard","iconUrl","shiftX","shiftY","dragBillboard","getExtentCorners","cartographicArrayToCartesianArray","Rectangle","northwest","northeast","southeast","southwest","mn","mx","epsilon","EPSILON7","clone","from","to","Array","Date","RegExp","Function","String","Number","Boolean","defaultOptions","newOptions","cesium3","createBillboardGroup","points","markers","BillboardGroup","addBillboards","_options","BillboardCollection","_billboards","_orderedBillboards","createBillboard","billboard","pixelOffset","eyeOffset","horizontalOrigin","HorizontalOrigin","CENTER","verticalOrigin","VerticalOrigin","image","getIndex","I","dragHandlers","onDragEnd","cartesian","onDrag","onDragStart","onDoubleClick","onClick","insertBillboard","addBillboard","updateBillboardsPositions","getBillboard","countBillboards","removeBillboard","removeAll","setOnTop","raiseToTop","mouseHandler","getDisplayLatLngString","precision","startDrawingPolyshape","poly","minPoints","pop","firstPoint","updateExtent","corners","highlighted","_highlighted","_strokeColor","fromCssColorString","editMode","_markers","updateHalfMarkers","editIndex","editMarkers","calculateHalfMarkerPosition","onEdited","cartographicToCartesian","EllipsoidGeodesic","interpolateUsingFraction","thisDragBillboard","thisDragHalfBillboard","dragHalfBillboard","handleMarkerChanges","halfPositions","handleEditMarkerChanges","_editMarkers","_globeClickhandler","Billboard","setEditable","_editable","editable","modeType","originalWidth","Extent","fromCartographicArray","cartesianArrayToCartographicArray","corner","ellipse","getMarkerPositions","Shapes","computeEllipseBoundary","getCircleCartesianCoordinates","createGeometry","PI_OVER_TWO","DrawHelperWidget","drawOptions","markerIcon","polylineIcon","polygonIcon","circleIcon","extentIcon","clearIcon","polylineDrawingOptions","polygonDrawingOptions","extentDrawingOptions","circleDrawingOptions","addIcon","url","webpackPolyfill","deprecate","children"],"mappings":"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","file":"Cesiums.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"Cesium\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"Cesium\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Cesiums\"] = factory(require(\"Cesium\"));\n\telse\n\t\troot[\"Cesiums\"] = factory(root[\"Cesium\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","export const __dirpath = getPathDir();\r\n\r\n/**\r\n * 用于组织管理输出,打包输出的内容依赖此文件的输出\r\n */\r\n/**Scene*/\r\nexport {Cameras} from \"./Scene/Cameras\"\r\nimport \"./Scene/Cameras.css\"\r\n\r\n/**Core*/\r\nexport {Cartesian3s} from \"./Core/Cartesian3s\"\r\nexport {eventSystem,EventType} from \"./Core/EventSystem\"\r\n\r\n\r\n/**DataSources*/\r\nexport {DazzlingLabelEntity} from \"./DataSources/DazzlingLabelEntity\"\r\nexport {EditableEntity} from \"./DataSources/EditableEntity\"\r\n\r\n\r\n/**Util**/\r\nimport * as officialUtils from \"./Util/OfficialUtils\";\r\nexport const OfficialUtils = officialUtils;\r\n\r\n/**Widgets**/\r\nexport {Settings} from  \"./Widgets/Settings\";\r\nexport {cesium1_50Patch} from  \"./Widgets/Patchs\";\r\n\r\n\r\n/*ThirdParty*/\r\nimport * as drawHelper from \"./ThirdParty/DrawHelper\";\r\nexport const DrawHelper = drawHelper;\r\n\r\nexport {ChoiceHelper} from \"./ThirdParty/ChoiceHelper\"\r\n\r\nimport \"./ThirdParty/DrawHelper.css\"\r\n\r\n\r\n\r\n//遍历script 获取src路径\r\nfunction getPathDir() {\r\n    let scriptSrc = \"\";\r\n    let nodeList = document.querySelectorAll(\"script\");\r\n    for(let i = 0; i< nodeList.length;i++){\r\n        if(/Cesiums[^\\/]*$/.test(nodeList.item(i).src)){\r\n            scriptSrc = nodeList.item(i).src;\r\n            break;\r\n        }\r\n    }\r\n\r\n    return scriptSrc.match(/(.+)\\/(Cesiums.js.*|Cesiums.min.js)/)[1];\r\n}\r\n\r\n","export const getWithDefault = (element, defaultElement) => {\r\n    return defined(element) ? element : defaultElement;\r\n}\r\n\r\nexport const defined = (element) =>{\r\n    return element !== null && element !== undefined;\r\n}\r\n\r\n","/**\r\n * 获取绕某点的圆 SampledPositionProperty\r\n * @param lon 角度\r\n * @param lat 角度\r\n * @param height\r\n * @param radius\r\n */\r\nexport const computeCirclularFlight = (lon, lat, height, radius) => {\r\n    let property = new Cesium.SampledPositionProperty();\r\n    let startAngle = Cesium.Math.nextRandomNumber() * 360.0;\r\n    let endAngle = startAngle + 360.0;\r\n\r\n    let increment = (Cesium.Math.nextRandomNumber() * 2.0 - 1.0) * 10.0 + 45.0;\r\n    for (let i = startAngle; i < endAngle; i += increment) {\r\n        let radians = Cesium.Math.toRadians(i);\r\n        let timeIncrement = i - startAngle;\r\n        let time = Cesium.JulianDate.addSeconds(start, timeIncrement, new Cesium.JulianDate());\r\n        let position = Cesium.Cartesian3.fromDegrees(lon + (radius * 1.5 * Math.cos(radians)), lat + (radius * Math.sin(radians)), height);\r\n        property.addSample(time, position);\r\n    }\r\n    return property;\r\n}\r\n\r\nexport const computeCirclularFlightPositions = (lon, lat, height, radius) => {\r\n    let positions = [];\r\n    let startAngle = Cesium.Math.nextRandomNumber() * 360.0;\r\n    let endAngle = startAngle + 360.0;\r\n\r\n    let increment = (Cesium.Math.nextRandomNumber() * 2.0 - 1.0) * 10.0 + 45.0;\r\n    for (let i = startAngle; i < endAngle; i += increment) {\r\n        let radians = Cesium.Math.toRadians(i);\r\n        let position = Cesium.Cartesian3.fromDegrees(lon + (radius * 1.5 * Math.cos(radians)), lat + (radius * Math.sin(radians)), height);\r\n        positions.push(position);\r\n    }\r\n    return positions;\r\n}\r\n\r\nexport const computeCirclularAugle = (increment) => {\r\n    let startAngle = Cesium.Math.nextRandomNumber() * 360.0;\r\n    let endAngle = startAngle + 360.0;\r\n    // let increment = (Cesium.Math.nextRandomNumber() * 2.0 - 1.0) * 10.0 + 45.0;\r\n\r\n    let angles = [];\r\n    for (let i = startAngle; i < endAngle; i += increment) {\r\n        angles.push(i)\r\n    }\r\n    return angles;\r\n}\r\n\r\nexport const computeCircle = (radius) => {\r\n    var positions = [];\r\n    for (var i = 0; i < 360; i++) {\r\n        var radians = Cesium.Math.toRadians(i);\r\n        positions.push(new Cesium.Cartesian2(radius * Math.cos(radians), radius * Math.sin(radians)));\r\n    }\r\n    return positions;\r\n}","import * as Cesium from \"Cesium\";\r\n\r\nexport class Cartesian3s {\r\n\r\n    /**\r\n     * 将地球坐标系基于WSG84椭球体转换成经纬度（弧度制）\r\n     * @param {Cesium.Cartesian3} cartesian3\r\n     * @returns {{height: *, latitude: *, longitude: *}}\r\n     */\r\n    static toRadians(cartesian3) {\r\n        return Cesium.Cartographic.fromCartesian(cartesian3);\r\n    }\r\n\r\n    /**\r\n     * 输出角度单位的经纬度\r\n     * @param {Cesium.Cartesian3}  cartesian3\r\n     * @returns {{height: *, latitude: *, longitude: *}}\r\n     */\r\n    static toDegrees(cartesian3) {\r\n        let cartographic = Cartesian3s.toRadians(cartesian3);\r\n        return {\r\n            height: cartographic.height,\r\n            latitude: Cesium.Math.toDegrees(cartographic.latitude),\r\n            longitude: Cesium.Math.toDegrees(cartographic.longitude)\r\n        };\r\n    }\r\n\r\n    /**\r\n     * 修正当前点位的高度\r\n     * @param {Cesium.Cartesian3} cartesian3\r\n     * @param {number} heightPlus - 修正高度，默认为5\r\n     */\r\n    static formatHeightPlus(cartesian3, heightPlus = 5) {\r\n        let fromCartesian = Cartesian3s.toRadians(cartesian3);\r\n        return Cesium.Cartesian3.fromRadians(fromCartesian.longitude, fromCartesian.latitude, fromCartesian.height + heightPlus);\r\n    }\r\n\r\n    /**\r\n     * 修正当前点位的高度到0\r\n     * @param {Cesium.Cartesian3} cartesian3\r\n     */\r\n    static formatHeightZero(cartesian3) {\r\n        let fromCartesian = Cartesian3s.toRadians(cartesian3);\r\n        return Cesium.Cartesian3.fromRadians(fromCartesian.longitude, fromCartesian.latitude, 0);\r\n    }\r\n\r\n    static formatHeight(cartesian3, height) {\r\n        let fromCartesian = Cartesian3s.toRadians(cartesian3);\r\n        return Cesium.Cartesian3.fromRadians(fromCartesian.longitude, fromCartesian.latitude, height);\r\n    }\r\n\r\n}","import * as Cesium from \"Cesium\";\r\nimport {defined} from \"../Util/NormalUtils\"\r\nimport {typeContaines} from \"../Util/TypeUtils\"\r\nimport {setListener} from \"../ThirdParty/DrawHelperV2/util/EventHelper\";\r\nimport {Settings} from \"../Widgets/Settings\"\r\n\r\n/**\r\n * 接管Cesium的事件系统（对于entity和primitive）\r\n */\r\n\r\nclass EventSystem {\r\n\r\n    constructor(accuracy = 3) {\r\n        this._init = false;\r\n        this._accuracy = accuracy;\r\n    }\r\n\r\n    /**\r\n     * 单地图\r\n     * @param viewer\r\n     */\r\n    setView(viewer) {\r\n        if (!this._init) {\r\n            this.viewer = viewer;\r\n            if (defined(viewer)) {\r\n                this._init = true;\r\n                this.eventBind();\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n\r\n    setAccuracy(value = 3) {\r\n        this._accuracy = value;\r\n        return this;\r\n    }\r\n\r\n    eventBind() {\r\n        let pressFlag = false;\r\n        let currentObject = null;\r\n        let firstFlag = true;\r\n        let handler = new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas);\r\n\r\n        handler.setInputAction((movement) => {\r\n            this.callPrimitiveCallback(EventType.LEFT_CLICK, movement.position);\r\n        }, Cesium.ScreenSpaceEventType.LEFT_CLICK);\r\n\r\n        handler.setInputAction((movement) => {\r\n            this.callPrimitiveCallback(EventType.LEFT_DOUBLE_CLICK, movement.position);\r\n        }, Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK);\r\n\r\n        handler.setInputAction((movement) => {\r\n            if (pressFlag) {\r\n                //第一次按下\r\n                if (firstFlag) {\r\n                    firstFlag = false;\r\n                    this.callPrimitiveCallbackCurrent(currentObject, EventType.DRAW_START, movement.endPosition)\r\n                } else {\r\n                    this.callPrimitiveCallbackCurrent(currentObject, EventType.DRAW, movement.endPosition)\r\n                }\r\n            } else {\r\n                this.callPrimitiveCallback(EventType.MOUSE_MOVE, movement.endPosition);\r\n            }\r\n\r\n        }, Cesium.ScreenSpaceEventType.MOUSE_MOVE);\r\n\r\n        handler.setInputAction((movement) => {\r\n            if (pressFlag) {\r\n                pressFlag = false;\r\n                this.callPrimitiveCallbackCurrent(currentObject, EventType.DRAW_END, movement.position);\r\n            } else {\r\n                this.callPrimitiveCallback(EventType.LEFT_UP, movement.position);\r\n            }\r\n\r\n            Settings.enableRotation(this.viewer,true);\r\n            currentObject = null;\r\n        }, Cesium.ScreenSpaceEventType.LEFT_UP);\r\n\r\n        handler.setInputAction((movement) => {\r\n            pressFlag = true;\r\n            currentObject = this.callPrimitiveCallback(EventType.LEFT_DOWN, movement.position);\r\n            if(currentObject){\r\n                Settings.enableRotation(this.viewer,false);\r\n            }\r\n        }, Cesium.ScreenSpaceEventType.LEFT_DOWN);\r\n    }\r\n\r\n    callPrimitiveCallback(eventName, position) {\r\n        let pickedObject = this.viewer.scene.pick(position, this._accuracy, this._accuracy);\r\n        //entity\r\n        if (pickedObject && typeContaines(pickedObject.id, \"Entity\")) {\r\n            return this.callPrimitiveCallbackCurrent(pickedObject.id,eventName,position)\r\n        }\r\n        //primitive\r\n        if (pickedObject && pickedObject.primitive) {\r\n            return this.callPrimitiveCallbackCurrent(pickedObject.primitive,eventName,position)\r\n        }\r\n    }\r\n\r\n    callPrimitiveCallbackCurrent(pickedObjectObj, eventName, position) {\r\n        pickedObjectObj[eventName] && pickedObjectObj[eventName](position);\r\n        return pickedObjectObj;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {Cesium.Entity | Cesium.Primitive} obj\r\n     * @param {string} type\r\n     * @param callback\r\n     */\r\n    setListener(obj, type, callback) {\r\n        if (defined(obj) && defined(type) && (typeof callback === \"function\")) {\r\n            obj[type] = callback;\r\n        }\r\n    }\r\n\r\n    //pass\r\n    onLeftClick(obj, callback) {\r\n        this.setListener(obj, EventType.LEFT_CLICK, callback);\r\n    }\r\n\r\n    onLeftDoubleClick(obj, callback) {\r\n        this.setListener(obj, EventType.LEFT_DOUBLE_CLICK, callback);\r\n    }\r\n\r\n    onMouseMove(obj, callback) {\r\n        this.setListener(obj, EventType.MOUSE_MOVE, callback);\r\n    }\r\n\r\n    onLeftUp(obj, callback) {\r\n        this.setListener(obj, EventType.LEFT_UP, callback);\r\n    }\r\n\r\n    onLeftDown(obj, callback) {\r\n        this.setListener(obj, EventType.LEFT_DOWN, callback);\r\n    }\r\n\r\n    onDrag(obj, callback) {\r\n        this.setListener(obj, EventType.DRAW, callback)\r\n    }\r\n\r\n    onDragEnd(obj, callback) {\r\n        this.setListener(obj, EventType.DRAW_END, callback)\r\n    }\r\n}\r\n\r\nexport const EventType = Object.freeze({\r\n    LEFT_CLICK: \"leftClick\",\r\n    LEFT_DOUBLE_CLICK: \"leftDoubleClick\",\r\n    MOUSE_MOVE: \"mouseMove\",\r\n    LEFT_UP: \"leftUp\",\r\n    LEFT_DOWN: \"leftDown\",\r\n    DRAW_START: \"drawStart\",\r\n    DRAW: \"draw\",\r\n    DRAW_END: \"drawEnd\"\r\n})\r\n\r\nexport const eventSystem = new EventSystem();\r\n","import * as Cesium from \"Cesium\";\r\n\r\n/**\r\n * 记录一些常用的设置\r\n */\r\nexport class Settings {\r\n    /**\r\n     * 清除默认的双击事件\r\n     * @param viewer\r\n     */\r\n    static cancelDefaultDbLeftClick(viewer){\r\n        viewer.cesiumWidget.screenSpaceEventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)\r\n    }\r\n\r\n    static cancelTilt(viewer){\r\n        viewer.scene.screenSpaceCameraController.enableTilt = false;\r\n    }\r\n\r\n    static enableRotation(viewer,enable = true){\r\n        viewer.scene.screenSpaceCameraController.enableRotate = enable;\r\n    }\r\n}","import * as Cesium from \"Cesium\";\r\nimport {computeCirclularAugle} from \"../Util/OfficialUtils\"\r\nimport {Cartesian3s} from \"..\";\r\nimport {defined} from \"../Util/NormalUtils\"\r\n\r\n/**\r\n * @namespace Cameras\r\n */\r\nexport class Cameras {\r\n    /**\r\n     * 获取一个目标点位向摄像头方向移动distance米的点位\r\n     * @param camera\r\n     * @param position\r\n     * @param distance\r\n     * @returns {*}\r\n     */\r\n    static getPositionAwayByCamara(camera, position, distance) {\r\n        let totalDistance = Cesium.Cartesian3.distance(camera.position, position, new Cesium.Cartesian3());\r\n        let subtract = Cesium.Cartesian3.subtract(camera.position, position, new Cesium.Cartesian3());\r\n        let add = Cesium.Cartesian3.multiplyByScalar(subtract, distance / totalDistance, new Cesium.Cartesian3());\r\n        return Cesium.Cartesian3.add(position, add, new Cesium.Cartesian3())\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param camera\r\n     * @param position 围绕的点位\r\n     * @param radius 围绕的半径\r\n     * @param second 转一圈的秒数\r\n     * @param increment 绕圈精度\r\n     * @param pitch 俯角\r\n     */\r\n    static flyAroundPosition(camera, position, radius, second = 20, increment = 0.1, pitch = -45) {\r\n        let angles = computeCirclularAugle(increment);\r\n        let index = 0;\r\n        let timeInterval = second * 1000 / angles.length;\r\n\r\n        let interval = setInterval(() => {\r\n            camera.lookAt(position, new Cesium.HeadingPitchRange(Cesium.Math.toRadians(angles[index]), Cesium.Math.toRadians(pitch), radius))\r\n            camera.lookAtTransform(Cesium.Matrix4.IDENTITY);//勉强确保摄像头坐标系正确\r\n            index = (++index) % angles.length;\r\n        }, timeInterval);\r\n\r\n        return () => {\r\n            clearInterval(interval);\r\n            camera.lookAtTransform(Cesium.Matrix4.IDENTITY);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 类似于Camera.lookAt\r\n     * 第三个参数是 Cesium.HeadingPitchRange\r\n     * @param camera\r\n     * @param position 面向的点位\r\n     * @param config 俯仰角配置\r\n     * @param config.heading\r\n     * @param config.pitch 俯仰角\r\n     * @param config.range 距离\r\n     * @param complete 飞行完成回调\r\n     * @param cancel 飞行取消回调\r\n     */\r\n    static flyAt(camera, position, {\r\n                     heading = 0,\r\n                     pitch = 0,\r\n                     range = 50,\r\n                 } = {},\r\n                 complete = () => {\r\n                 },\r\n                 cancel = () => {\r\n                 }) {\r\n        pitch = Cesium.Math.toRadians(pitch);\r\n        heading = Cesium.Math.toRadians(heading);\r\n\r\n        // let x = Math.sqrt(1 / (Math.pow(Math.tan(-pitch), 2) + 1) / (1 + Math.pow(Math.tan(-heading), 2)));\r\n        // // let y = Math.sqrt(1 / (Math.pow(Math.tan(-pitch), 2) + 1) / (1 / (Math.pow(Math.tan(-heading), 2) + 1)));\r\n        // let z = Math.sqrt(Math.pow(Math.tan(-pitch), 2) / (Math.pow(Math.tan(-pitch), 2) + 1));\r\n        // let y = Math.sqrt(1 - Math.pow(x, 2) - (Math.pow(z, 2)));\r\n        // let relativePosition = Cesium.Cartesian3.multiplyByScalar(new Cesium.Cartesian3(x, y, z), range, new Cesium.Cartesian3());\r\n\r\n        let rotationTranslation = Cesium.Matrix4.fromRotationTranslation(Cesium.Matrix3.fromHeadingPitchRoll(new Cesium.HeadingPitchRoll(heading + Math.PI / 2, -pitch, 0)));\r\n        let relativePosition = Cesium.Matrix4.multiplyByPoint(rotationTranslation, new Cesium.Cartesian3(range, 0, 0), new Cesium.Cartesian3());\r\n\r\n        let earthTransform = Cesium.Transforms.eastNorthUpToFixedFrame(position, Cesium.Ellipsoid.WGS84, new Cesium.Matrix4());\r\n        let cameraPosition = Cesium.Matrix4.multiplyByPoint(earthTransform, relativePosition, new Cesium.Cartesian3());\r\n\r\n        camera.flyTo({\r\n            destination: cameraPosition,\r\n            orientation: {\r\n                heading: heading,\r\n                pitch: pitch,\r\n                roll: 0.0\r\n            },\r\n            complete: complete,\r\n            cancel: cancel\r\n        });\r\n    }\r\n\r\n    /**\r\n     *  保存当前摄像头的位置\r\n     * @param camera\r\n     * @returns {string} uri编码后的数据\r\n     */\r\n    static saveCameraStatus(camera) {\r\n        let data = {\r\n            position: camera.position,\r\n            heading: camera.heading,\r\n            pitch: camera.pitch,\r\n            roll: camera.roll,\r\n        };\r\n        var dataCompress = [\r\n            data.position.x.toFixed(2),\r\n            data.position.y.toFixed(2),\r\n            data.position.z.toFixed(2),\r\n            data.heading.toFixed(2),\r\n            data.pitch.toFixed(2),\r\n            data.roll.toFixed(2)\r\n        ]\r\n\r\n        return encodeURIComponent(dataCompress.join(\",\"));\r\n    }\r\n\r\n    /**\r\n     * 加载\r\n     * @param camera\r\n     * @param data\r\n     * @param isFly\r\n     */\r\n    static loadCameraStatus(camera, data, isFly = false, errorCallback) {\r\n        try {\r\n            let dataCompress = decodeURIComponent(data).split(\",\");\r\n\r\n            if (defined(dataCompress) && dataCompress.length >= 6) {\r\n                let target = {\r\n                    destination: {\r\n                        x: parseFloat(dataCompress[0]),\r\n                        y: parseFloat(dataCompress[1]),\r\n                        z: parseFloat(dataCompress[2])\r\n                    },\r\n                    orientation: {\r\n                        heading: parseFloat(dataCompress[3]),\r\n                        pitch: parseFloat(dataCompress[4]),\r\n                        roll: parseFloat(dataCompress[5])\r\n                    }\r\n                };\r\n                if (isFly) {\r\n                    camera.flyTo(target);\r\n                } else {\r\n                    camera.setView(target);\r\n                }\r\n            } else throw \"not define position| heading | pitch | roll\";\r\n        } catch (e) {\r\n            console.error(e);\r\n            if (typeof errorCallback === 'function') errorCallback(e);\r\n        }\r\n    }\r\n\r\n}\r\n","import {defined} from \"./NormalUtils\"\r\n\r\nexport const isType = (instance, typeName) => {\r\n    if (typeof instance === \"object\" && defined(instance.constructor)) {\r\n        return instance.constructor.toString().match(/^function\\s*([^\\s(]+)/)[1] === typeName;\r\n    }\r\n    return false;\r\n}\r\n\r\n/**\r\n * 类名包含\r\n * @param instance\r\n * @param typeName\r\n * @returns {boolean}\r\n */\r\nexport const typeContaines = (instance, typeName) => {\r\n    if (typeof instance === \"object\" && defined(instance.constructor)) {\r\n        let typeMatchGroup = instance.constructor.toString().match(/^function\\s*([^\\s(]+)/);\r\n        if (defined(typeMatchGroup) && defined(typeMatchGroup[1])) {\r\n            return typeMatchGroup[1].indexOf(typeName) !== -1;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport const getType = (instance) => {\r\n    if (typeof instance === \"object\" && defined(instance.constructor)) {\r\n        let typeMatchGroup = instance.constructor.toString().match(/^function\\s*([^\\s(]+)/);\r\n        if (defined(typeMatchGroup) && defined(typeMatchGroup[1])) {\r\n            return typeMatchGroup[1];\r\n        }\r\n    }\r\n    return undefined;\r\n}\r\n","export const setListener = (primitive, type, callback) => {\r\n    primitive[type] = callback;\r\n}\r\n\r\nexport const removeListener = (primitive, type) => {\r\n    delete primitive[type];\r\n}\r\n\r\nexport const enhanceWithListeners = (element) => {\r\n    element._listeners = {};\r\n\r\n    element.addListener = function (name, callback) {\r\n        this._listeners[name] = (this._listeners[name] || []);\r\n        this._listeners[name].push(callback);\r\n        return this._listeners[name].length;\r\n    }\r\n\r\n    element.executeListeners = function (event, defaultCallback) {\r\n        if (this._listeners[event.name] && this._listeners[event.name].length > 0) {\r\n            var index = 0;\r\n            for (; index < this._listeners[event.name].length; index++) {\r\n                this._listeners[event.name][index](event);\r\n            }\r\n        } else {\r\n            if (defaultCallback) {\r\n                defaultCallback(event);\r\n            }\r\n        }\r\n    }\r\n}","import * as Cesium from \"Cesium\";\r\nimport {Cartesian3s} from \"../Core/Cartesian3s\";\r\nimport {SimpleCosBuilder} from \"../Util/Math\"\r\nimport {BaseEntity} from \"./BaseEntity\";\r\nimport {__dirpath} from \"../index\";\r\n\r\n/**\r\n * 无法解决单个entity引用模型的问题\r\n */\r\nexport class DazzlingLabelEntity extends BaseEntity {\r\n    /**\r\n     *\r\n     * @param config\r\n     * @param modelColor\r\n     * @param width\r\n     * @param timePeriod\r\n     * @param relativeSize\r\n     */\r\n    constructor(config, {\r\n        modelColor = Cesium.Color.DARKVIOLET,\r\n        line: {\r\n            width = 5\r\n        } = {},\r\n        ring: {\r\n            timePeriod = 10,\r\n            relativeSize = 1\r\n        } = {}\r\n    } = {}) {\r\n        super(config)\r\n        // let simpleSin = new SimpleSinBuilder().setPeriod(20).setAmplitude(1).setPhase(0).build();\r\n        let simpleCos = new SimpleCosBuilder().setPeriod(timePeriod / 2).setAmplitude(-0.5).setPhase(0).build();\r\n        let startTime = Cesium.JulianDate.now();\r\n\r\n        this.ringEntity = new Cesium.Entity({\r\n            position: new Cesium.CallbackProperty((time, result) => {\r\n                return Cartesian3s.formatHeight(config.position,\r\n                    (0.5 + simpleCos.calc(Cesium.JulianDate.secondsDifference(Cesium.JulianDate.now(), startTime) % (timePeriod / 2))) * Cartesian3s.toRadians(config.position).height\r\n                );\r\n            }, false),\r\n            model: {\r\n                uri: __dirpath + \"/resources/圆环.glb\",\r\n                scale: new Cesium.CallbackProperty((time, result) => {\r\n                    // this.viewer.scene.camera.position\r\n                    return Cesium.Cartesian3.distance(config.position, this.viewer.scene.camera.position) * relativeSize / 340;\r\n                    // return 0.1;\r\n                }, false),\r\n                maximumScale: 1,\r\n                color: modelColor,\r\n                show: new Cesium.CallbackProperty((time, result) => {\r\n                    return this.selected;\r\n                }, false)\r\n            },\r\n            polyline: {\r\n                positions: [Cartesian3s.formatHeightZero(config.position), config.position],\r\n                width: width,\r\n                material: modelColor\r\n            }\r\n        });\r\n        this.ringEntity.parent = this;\r\n\r\n        this.initEvent();\r\n        this.selected = false;\r\n    }\r\n\r\n    setViewer(viewer) {\r\n        this.viewer = viewer;\r\n        viewer.entities.add(this);\r\n        viewer.entities.add(this.ringEntity);\r\n    }\r\n\r\n    removeViewer(viewer) {\r\n        viewer.entities.add(this);\r\n        viewer.entities.add(this.ringEntity);\r\n    }\r\n}\r\n\r\n","export const SimpleSin = class {\r\n    constructor(A, k, b) {\r\n        this.A = A;\r\n        this.k = k;\r\n        this.b = b;\r\n        return this;\r\n    }\r\n\r\n    calc(x) {\r\n        return Math.sin(this.k * x + this.b) * this.A;\r\n    }\r\n}\r\n\r\nexport const SimpleSinBuilder = class {\r\n    setPeriod(number) {\r\n        this.k = 2 * Math.PI / number;\r\n        return this;\r\n    }\r\n\r\n    setAmplitude(number) {\r\n        this.A = number;\r\n        return this;\r\n    }\r\n\r\n    setPhase(number) {\r\n        this.b = number;\r\n        return this;\r\n    }\r\n\r\n    build() {\r\n        return new SimpleSin(this.A, this.k, this.b)\r\n    }\r\n}\r\n\r\n\r\nexport const simpleCos = class  {\r\n    constructor(A, k, b) {\r\n        this.A = A;\r\n        this.k = k;\r\n        this.b = b;\r\n        return this;\r\n    }\r\n\r\n    calc(x) {\r\n        return Math.cos(this.k * x + this.b) * this.A;\r\n    }\r\n}\r\n\r\nexport const SimpleCosBuilder = class {\r\n    setPeriod(number) {\r\n        this.k = 2 * Math.PI / number;\r\n        return this;\r\n    }\r\n\r\n    setAmplitude(number) {\r\n        this.A = number;\r\n        return this;\r\n    }\r\n\r\n    setPhase(number) {\r\n        this.b = number;\r\n        return this;\r\n    }\r\n\r\n    build() {\r\n        return new simpleCos(this.A, this.k, this.b)\r\n    }\r\n}","import * as Cesium from \"Cesium\";\r\nimport {eventSystem} from \"../Core/EventSystem\";\r\n\r\n/**\r\n * 基础entity\r\n * 改变了，继承改变 display/hide/add/remove方向\r\n * 选择选中接口对外开放\r\n * 点击事件\r\n */\r\nexport class BaseEntity extends Cesium.Entity {\r\n    constructor(config) {\r\n        super(config);\r\n    }\r\n\r\n    setViewer(viewer) {\r\n        viewer.entities.add(this);\r\n    }\r\n\r\n    removeViewer(viewer) {\r\n        viewer.entities.remove(this);\r\n    }\r\n\r\n    display() {\r\n        this.show = true;\r\n    }\r\n\r\n    hide() {\r\n        this.show = false;\r\n    }\r\n\r\n    set selected(selected){\r\n        this._selected = selected;\r\n        if(this.selected){\r\n            typeof this._selectedCallback() === \"function\" && this._selectedCallback();\r\n        }else{\r\n            typeof this._releaseCallback === \"function\" && this._releaseCallback();\r\n        }\r\n    }\r\n\r\n    get selected(){\r\n        return this._selected;\r\n    }\r\n\r\n    setSelected(selected = true) {\r\n        this.selected = selected;\r\n    }\r\n\r\n    cancelSelected() {\r\n        this.selected = false;\r\n    }\r\n\r\n    onSelect(callback = () => {\r\n    }) {\r\n        this._selectedCallback = callback;\r\n    }\r\n\r\n    onRelease(callback = () => {\r\n    }) {\r\n        this._releaseCallback = callback;\r\n    }\r\n\r\n    initEvent() {\r\n        eventSystem.onLeftClick(this, (position) => {\r\n            // this.onSelected ^= true;//反向\r\n            if (typeof this.onClickCallback === \"function\") {\r\n                this.onClickCallback(position);\r\n            }\r\n        })\r\n    }\r\n\r\n    onClick(callback) {\r\n        this.onClickCallback = callback;\r\n    }\r\n}","import * as Cesium from \"Cesium\";\r\n\r\nexport class EditableEntity extends Cesium.Entity{\r\n    test(){\r\n        console.log(\"test\");\r\n    }\r\n\r\n    static test2(){\r\n        console.log(\"test2\");\r\n    }\r\n}","export const cesium1_50Patch = () => {\r\n    var fixGltf = function (gltf) {\r\n        if (!gltf.extensionsUsed) {\r\n            return;\r\n        }\r\n\r\n        var v = gltf.extensionsUsed.indexOf('KHR_technique_webgl');\r\n        var t = gltf.extensionsRequired.indexOf('KHR_technique_webgl');\r\n        // 中招了。。\r\n        if (v !== -1) {\r\n            gltf.extensionsRequired.splice(t, 1, 'KHR_techniques_webgl');\r\n            gltf.extensionsUsed.splice(v, 1, 'KHR_techniques_webgl');\r\n            gltf.extensions = gltf.extensions || {};\r\n            gltf.extensions['KHR_techniques_webgl'] = {};\r\n            gltf.extensions['KHR_techniques_webgl'].programs = gltf.programs;\r\n            gltf.extensions['KHR_techniques_webgl'].shaders = gltf.shaders;\r\n            gltf.extensions['KHR_techniques_webgl'].techniques = gltf.techniques;\r\n            var techniques = gltf.extensions['KHR_techniques_webgl'].techniques;\r\n\r\n            gltf.materials.forEach(function (mat, index) {\r\n                gltf.materials[index].extensions['KHR_technique_webgl'].values = gltf.materials[index].values;\r\n                gltf.materials[index].extensions['KHR_techniques_webgl'] = gltf.materials[index].extensions['KHR_technique_webgl'];\r\n\r\n                var vtxfMaterialExtension = gltf.materials[index].extensions['KHR_techniques_webgl'];\r\n\r\n                for (var value in vtxfMaterialExtension.values) {\r\n                    var us = techniques[vtxfMaterialExtension.technique].uniforms;\r\n                    for (var key in us) {\r\n                        if (us[key] === value) {\r\n                            vtxfMaterialExtension.values[key] = vtxfMaterialExtension.values[value];\r\n                            delete vtxfMaterialExtension.values[value];\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                ;\r\n            });\r\n\r\n            techniques.forEach(function (t) {\r\n                for (var attribute in t.attributes) {\r\n                    var name = t.attributes[attribute];\r\n                    t.attributes[attribute] = t.parameters[name];\r\n                }\r\n                ;\r\n\r\n                for (var uniform in t.uniforms) {\r\n                    var name = t.uniforms[uniform];\r\n                    t.uniforms[uniform] = t.parameters[name];\r\n                }\r\n                ;\r\n            });\r\n        }\r\n    }\r\n\r\n    Object.defineProperties(Cesium.Model.prototype, {\r\n        _cachedGltf: {\r\n            set: function (value) {\r\n                this._vtxf_cachedGltf = value;\r\n                if (this._vtxf_cachedGltf && this._vtxf_cachedGltf._gltf) {\r\n                    fixGltf(this._vtxf_cachedGltf._gltf);\r\n                }\r\n            },\r\n            get: function () {\r\n                return this._vtxf_cachedGltf;\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\n","/*   if (typeof exports === 'object' && typeof module === 'object')\r\n       module.exports = factory(require('Cesium'), require('DrawHelper'));\r\n   else if (typeof define === 'function' && define.amd)\r\n       define('ChoiceHelper', [ 'Cesium', 'DrawHelper'], factory);\r\n   else {\r\n       root.ChoiceHelper = factory(root.Cesium, root.DrawHelper);\r\n   }*/\r\nimport * as Cesium from \"Cesium\";\r\nimport {DrawHelper} from \"../index\"\r\n\r\n// export const ChoiceHelper =  factory(Cesium,DrawHelper);\r\n\r\n\r\n/**\r\n * @param {Object} config\r\n * @param {Object} config.viewer - Cesium.viewer对象\r\n * @param {Object} config.toolbar - toolbar,为空则不创建\r\n * @param {Element} config.toolbar.container - toolbar所在容器\r\n * @param {string[]} config.toolbar.buttons - 包括 'polygon', 'circle', 'extent' 代表多边形、圆形、矩形\r\n * @param {Object} config.dom - dom事件绑定模式\r\n * @param {Element} config.polygon - 绑定开始画polygon的事件\r\n * @param {Element} config.marker - 绑定开始画marker的事件\r\n * @param {Element} config.extent - 绑定开始画extent的事件\r\n * @param {Element} config.circle - 绑定开始画circle的事件\r\n * @param {Element} config.clear - 清空绘制事件\r\n * @param {Element} config.cancel - 结束绘制事件\r\n * @param {Array} config.callbacks - 选择回调，可配置多种选择回调\r\n * @param {function(Cesium.Entity):boolean} config.callbacks.choice[].filter - 过滤器，即选择器,确认为需要选择的对象，返回ture\r\n * @param {function(Cesium.Entity[])} config.callbacks.choice[].onChoice - 选择回调\r\n * @param {function(Cesium.Cartesian3)} config.callbacks.marker - marker创建回调\r\n * @param {function} config.callbacks.afterClick - 工具栏点击回调\r\n * {\r\n *     viewer: viewer对象,\r\n *     toolbar:{\r\n *         container: toolbar所在容器,\r\n *         buttons: [],//\r\n *     },\r\n *     dom:{//\r\n *             polygon: function | dom ,\r\n *             marker: function | dom ,\r\n *             extent: function | dom ,\r\n *             circle: function | dom ,\r\n *             clear : dom,\r\n *             cancel : dom\r\n *     },\r\n *     callbacks:{\r\n *          choice:[{\r\n *             filter: function\r\n *             onChoice: function\r\n *         }],\r\n *         marker: function,\r\n *         afterClick: function,\r\n *     }\r\n * }\r\n * @constructor\r\n */\r\nexport function ChoiceHelper(config) {\r\n    this._cesiumViewer = config.viewer;\r\n    this.util = new Util(this._cesiumViewer);\r\n\r\n    this._scene = this._cesiumViewer.scene;\r\n    this._drawHelper = new DrawHelper(this._cesiumViewer);\r\n    this._option = config;\r\n    this._afterClick = config.callbacks.afterClick;\r\n\r\n    this._primitives = [];\r\n    var me = this;\r\n\r\n    if (Cesium.defined(config.toolbar) && Cesium.defined(config.toolbar.container)) {\r\n        this._toolbarContainer = config.toolbar.container;\r\n\r\n        this._toolbar = this._drawHelper.addToolbar(this._toolbarContainer, {\r\n            buttons: config.toolbar.buttons,\r\n            clickCallback: function (event) {\r\n                //移除之前绘制的\r\n                me._afterClick && me._afterClick();\r\n                me.util.getWithDefault(me._primitives, []).forEach(function (element, index) {\r\n                    me._scene.primitives.remove(element);\r\n                })\r\n            },\r\n            //点位选取策略配置\r\n            pickStrategy: pickStrategy\r\n        })\r\n    } else if (Cesium.defined(config.dom)) {\r\n        this._toolbar = this._drawHelper.addToolbar(document.body, {buttons: []});\r\n        var toolbar = this._toolbar;\r\n        config.dom.polygon && function () {\r\n            var lastOnclick = config.dom.polygon.onclick;\r\n            config.dom.polygon.onclick = function (e) {\r\n                lastOnclick && lastOnclick(e);\r\n\r\n                me._afterClick && me._afterClick();\r\n                me._drawHelper.startDrawingPolygon({\r\n                    callback: function (positions, self) {\r\n                        toolbar.executeListeners({name: 'polygonCreated', positions: positions});\r\n                    },\r\n                    strategy: {\r\n                        pickStrategy: pickStrategy\r\n                    }\r\n                });\r\n            }\r\n            // $(config.dom.polygon).on('click', function (e) {\r\n            //     me._afterClick && me._afterClick();\r\n            //     me._drawHelper.startDrawingPolygon({\r\n            //         callback: function (positions, self) {\r\n            //             toolbar.executeListeners({name: 'polygonCreated', positions: positions});\r\n            //         },\r\n            //         strategy: {\r\n            //             pickStrategy: pickStrategy\r\n            //         }\r\n            //     });\r\n            // });\r\n        }();\r\n        config.dom.polygon && function () {\r\n            var lastOnclick = config.dom.polyline.onclick;\r\n            config.dom.polyline.onclick = function (e) {\r\n                lastOnclick && lastOnclick(e);\r\n                me._afterClick && me._afterClick();\r\n                me._drawHelper.startDrawingPolyline({\r\n                    callback: function (positions, self) {\r\n                        toolbar.executeListeners({name: 'polylineCreated', positions: positions});\r\n                    },\r\n                    strategy: {\r\n                        pickStrategy: pickStrategy\r\n                    }\r\n                });\r\n            }\r\n            // $(config.dom.polyline).on('click', function (e) {\r\n            //     me._afterClick && me._afterClick();\r\n            //     me._drawHelper.startDrawingPolyline({\r\n            //         callback: function (positions, self) {\r\n            //             toolbar.executeListeners({name: 'polylineCreated', positions: positions});\r\n            //         },\r\n            //         strategy: {\r\n            //             pickStrategy: pickStrategy\r\n            //         }\r\n            //     });\r\n            // });\r\n        }();\r\n        config.dom.marker && function () {\r\n            var lastOnclick = config.dom.marker.onclick;\r\n            config.dom.marker.onclick = function (e) {\r\n                lastOnclick && lastOnclick(e);\r\n                me._afterClick && me._afterClick();\r\n                me._drawHelper.startDrawingMarker({\r\n                    callback: function (position, self) {\r\n                        toolbar.executeListeners({name: 'markerCreated', position: position});\r\n                    },\r\n                    strategy: {\r\n                        pickStrategy: pickStrategy\r\n                    }\r\n                });\r\n            }\r\n            // $(config.dom.marker).on('click', function (e) {\r\n            //     me._afterClick && me._afterClick();\r\n            //     me._drawHelper.startDrawingMarker({\r\n            //         callback: function (position, self) {\r\n            //             toolbar.executeListeners({name: 'markerCreated', position: position});\r\n            //         },\r\n            //         strategy: {\r\n            //             pickStrategy: pickStrategy\r\n            //         }\r\n            //     });\r\n            // });\r\n        }();\r\n        config.dom.extent && function () {\r\n            var lastOnclick = config.dom.extent.onclick;\r\n\r\n            config.dom.extent.onclick = function (e) {\r\n                lastOnclick && lastOnclick(e);\r\n                me._afterClick && me._afterClick();\r\n                me._drawHelper.startDrawingExtent({\r\n                    callback: function (extent, self) {\r\n                        toolbar.executeListeners({name: 'extentCreated', extent: extent});\r\n                    },\r\n                    strategy: {\r\n                        pickStrategy: pickStrategy\r\n                    }\r\n                });\r\n            }\r\n            // $(config.dom.extent).on('click', function (e) {\r\n            //     me._afterClick && me._afterClick();\r\n            //     me._drawHelper.startDrawingExtent({\r\n            //         callback: function (extent, self) {\r\n            //             toolbar.executeListeners({name: 'extentCreated', extent: extent});\r\n            //         },\r\n            //         strategy: {\r\n            //             pickStrategy: pickStrategy\r\n            //         }\r\n            //     });\r\n            // });\r\n        }();\r\n        config.dom.circle && function () {\r\n            var lastOnclick = config.dom.circle.onclick;\r\n\r\n            config.dom.circle.onclick = function (e) {\r\n                lastOnclick && lastOnclick(e);\r\n                me._afterClick && me._afterClick();\r\n                me._drawHelper.startDrawingCircle({\r\n                    callback: function (center, radius, self) {\r\n                        toolbar.executeListeners({name: 'circleCreated', center: center, radius: radius});\r\n                    },\r\n                    strategy: {\r\n                        pickStrategy: pickStrategy\r\n                    }\r\n                });\r\n            }\r\n            // $(config.dom.circle).on('click', function (e) {\r\n            //     me._afterClick && me._afterClick();\r\n            //     me._drawHelper.startDrawingCircle({\r\n            //         callback: function (center, radius, self) {\r\n            //             toolbar.executeListeners({name: 'circleCreated', center: center, radius: radius});\r\n            //         },\r\n            //         strategy: {\r\n            //             pickStrategy: pickStrategy\r\n            //         }\r\n            //     });\r\n            // });\r\n        }();\r\n        config.dom.clear && function () {\r\n            var lastOnclick = config.dom.clear.onclick;\r\n\r\n            config.dom.clear.onclick = function (e) {\r\n                lastOnclick && lastOnclick(e);\r\n                me._afterClick && me._afterClick();\r\n            }\r\n            // $(config.dom.clear).on('click', function (e) {\r\n            //     me._afterClick && me._afterClick();\r\n            //\r\n            // });\r\n        }();\r\n        config.dom.cancel && function () {\r\n            var lastOnclick = config.dom.cancel.onclick;\r\n\r\n            config.dom.cancel.onclick = function (e) {\r\n                lastOnclick && lastOnclick(e);\r\n                me._afterClick && me._afterClick();\r\n                me._drawHelper.stopDrawing()\r\n            }\r\n            // $(config.dom.cancel).on('click', function (e) {\r\n            //     me._afterClick && me._afterClick();\r\n            //     me._drawHelper.stopDrawing()\r\n            // });\r\n        }();\r\n    } else {\r\n        console.error(\"传入参数有误！\");\r\n        return;\r\n    }\r\n    this._eventInit();\r\n}\r\n\r\nvar pickStrategy = function (position, viewer) {\r\n    if (Cesium.defined(viewer.scene.pick(position)) && viewer.scene.pickPositionSupported) {\r\n        return viewer.scene.pickPosition(position);\r\n        // var fromCartesian = Cesium.Cartographic.fromCartesian(viewer.scene.pickPosition(position));\r\n        // return Cesium.Cartesian3.fromRadians(fromCartesian.longitude, fromCartesian.latitude, 0);\r\n    } else {\r\n        var fromCartesian = Cesium.Cartographic.fromCartesian(viewer.scene.camera.pickEllipsoid(position));\r\n        return Cesium.Cartesian3.fromRadians(fromCartesian.longitude, fromCartesian.latitude, 0);\r\n    }\r\n};\r\n\r\nChoiceHelper.prototype._optionReload = function () {\r\n\r\n}\r\n\r\nChoiceHelper.prototype._eventInit = function () {\r\n    var me = this;\r\n    me._toolbar.addListener('polygonCreated', function (event) {\r\n        var polygon = new DrawHelper.PolygonPrimitive({\r\n            positions: event.positions,\r\n            material: Cesium.Material.fromType('Checkerboard')\r\n        });\r\n\r\n        console.log(event)\r\n        var LatLngPaths = [];\r\n\r\n        me.util.getWithDefault(event.positions, []).forEach(function (position, index) {\r\n            LatLngPaths.push(me.util.Cartesian3ToLatLng(position));\r\n        });\r\n\r\n\r\n        me._filterExecuter(function (entities) {\r\n            var parseEntities = [];\r\n            me.util.getWithDefault(entities, []).forEach(function (entity, index) {\r\n                var latlng = Cesium.Cartographic.fromCartesian(entity.position.getValue(0));\r\n                if (me.util._isInPolygon(latlng, LatLngPaths)) {\r\n                    parseEntities.push(entity);\r\n                }\r\n            });\r\n            return parseEntities;\r\n        })\r\n\r\n\r\n    });\r\n    // circle.center :  Cartesian3\r\n    // circle.ellipsoid._maximumRadius : number\r\n    // circle.ellipsoid._minimumRadius : number\r\n    me._toolbar.addListener('circleCreated', function (event) {\r\n\r\n        // var r = event.radius\r\n        me._filterExecuter(function (entities) {\r\n            var parseEntities = [];\r\n\r\n            me.util.getWithDefault(entities, []).forEach(function (entity, index) {\r\n                var latlng = Cesium.Cartographic.fromCartesian(entity.position.getValue(0));\r\n                var groundPosition = Cesium.Cartesian3.fromRadians(latlng.longitude, latlng.latitude, 0.0);\r\n                if (Cesium.Cartesian3.distance(me.util.getCesiumHightZero(event.center), groundPosition) <= event.radius) {\r\n                    parseEntities.push(entity);\r\n                }\r\n            })\r\n\r\n            return parseEntities;\r\n        });\r\n    });\r\n\r\n    //Cesium.Rectangle.subsample(e.extent)\r\n    me._toolbar.addListener('extentCreated', function (e) {\r\n        var extent = e.extent;\r\n\r\n        me._filterExecuter(function (entities) {\r\n            var parseEntities = [];\r\n\r\n            me.util.getWithDefault(entities, []).forEach(function (entity, index) {\r\n                var cartesian3ToLatLng = me.util.Cartesian3ToLatLng(entity.position.getValue(0));\r\n                if (extent.west <= cartesian3ToLatLng.longitude && extent.east >= cartesian3ToLatLng.longitude\r\n                    && extent.south <= cartesian3ToLatLng.latitude && extent.north >= cartesian3ToLatLng.latitude) {\r\n                    parseEntities.push(entity);\r\n                }\r\n            })\r\n\r\n            return parseEntities;\r\n        });\r\n    });\r\n\r\n    me._toolbar.addListener('markerCreated', function (event) {\r\n        me._option.callbacks.marker(event.position);\r\n        // loggingMessage('Marker created at ' + event.position.toString());\r\n        // create one common billboard collection for all billboards\r\n        // var b = new Cesium.BillboardCollection();\r\n        // viewer.scene.primitives.add(b);\r\n        // var billboard = b.add({\r\n        //     show : true,\r\n        //     position : event.position,\r\n        //     pixelOffset : new Cesium.Cartesian2(0, 0),\r\n        //     eyeOffset : new Cesium.Cartesian3(0.0, 0.0, 0.0),\r\n        //     horizontalOrigin : Cesium.HorizontalOrigin.CENTER,\r\n        //     verticalOrigin : Cesium.VerticalOrigin.CENTER,\r\n        //     scale : 1.0,\r\n        //     image: './img/glyphicons_242_google_maps.png',\r\n        //     color : new Cesium.Color(1.0, 1.0, 1.0, 1.0)\r\n        // });\r\n        // billboard.setEditable();\r\n    });\r\n}\r\n\r\n\r\nChoiceHelper.prototype.setOption = function (option) {\r\n\r\n}\r\n\r\nChoiceHelper.prototype._callBack = function () {\r\n\r\n}\r\n\r\nChoiceHelper.prototype._filterExecuter = function (containsCallback) {\r\n    var me = this;\r\n    //选出在圈内的entities\r\n    var containEntities = containsCallback(me._cesiumViewer.entities.values);\r\n\r\n    me.util.getWithDefault(me._option.callbacks.choice, []).forEach(function (callback, index) {\r\n        var entities = [];\r\n        //过滤出需要的entity\r\n        me.util.getWithDefault(containEntities, []).forEach(function (entity, index2) {\r\n            if (callback.filter(entity)) entities.push(entity);\r\n        })\r\n        //callback\r\n        callback.onChoice(entities);\r\n    })\r\n\r\n};\r\n\r\n\r\nfunction Util(viewer) {\r\n    this._viewer = viewer;\r\n    this._ellipsoid = this._viewer.scene.globe._ellipsoid;\r\n}\r\n\r\n/**\r\n * 将Cartesian3转为经纬度\r\n * @param cartesian3\r\n * @returns {{height:number,latitude:number,longitude:number}}\r\n */\r\nUtil.prototype.Cartesian3ToLatLng = function (cartesian3) {\r\n    // return  Cesium.Cartographic.fromCartesian(cartesian3);\r\n    return this._ellipsoid.cartesianToCartographic(cartesian3);\r\n}\r\n/**\r\n * 但是Cesium不支持此类\r\n * @param cartesian3\r\n * @return {{height: *, latitude: *, longitude: *}}\r\n * @constructor\r\n */\r\nUtil.prototype.Cartesian3ToDegrees = function (cartesian3) {\r\n    var cartographic = this._ellipsoid.cartesianToCartographic(cartesian3);\r\n    var degree = {\r\n        height: cartographic.height,\r\n        latitude: Cesium.Math.toDegrees(cartographic.latitude),\r\n        longitude: Cesium.Math.toDegrees(cartographic.longitude)\r\n    }\r\n    return degree;\r\n}\r\n\r\nUtil.prototype.getWithDefault = function (element, defaultElement) {\r\n    return element ? element : defaultElement;\r\n}\r\n\r\n/**\r\n * 获取当前点位的近地点位\r\n * @param {Cesium.Cartesian3} cartesian3\r\n * @return {Cesium.Cartesian3}\r\n */\r\nUtil.prototype.getCesiumHightZero = function (cartesian3) {\r\n    var fromCartesian = Cesium.Cartographic.fromCartesian(cartesian3);\r\n    return Cesium.Cartesian3.fromRadians(fromCartesian.longitude, fromCartesian.latitude, 0);\r\n}\r\n\r\n/**\r\n * 修正当前点位的高度\r\n * @param {Cesium.Cartesian3} cartesian3\r\n * @param {number} heightPlus\r\n * @return {Cesium.Cartesian3}\r\n */\r\nUtil.prototype.formatHetightPlusNumber = function (cartesian3, heightPlus) {\r\n    var fromCartesian = Cesium.Cartographic.fromCartesian(cartesian3);\r\n    return Cesium.Cartesian3.fromRadians(fromCartesian.longitude, fromCartesian.latitude, fromCartesian.height + heightPlus);\r\n\r\n}\r\n\r\n/**\r\n *\r\n * @param position\r\n * @param paths\r\n */\r\nUtil.prototype._isInPolygon = function (position, paths) {\r\n    var x = position.longitude;\r\n    var y = position.latitude;\r\n\r\n    var isum, icount, index = 0;\r\n    var dLon1 = 0, dLon2 = 0, dLat1 = 0, dLat2 = 0, dLon;\r\n\r\n    if (paths.size < 3) {\r\n        return false;\r\n    }\r\n\r\n    isum = 0;\r\n    icount = paths.length;\r\n\r\n    for (index = 0; index < icount - 1; index++) {\r\n        if (index === icount - 1) {\r\n            dLon1 = paths[index].longitude;\r\n            dLat1 = paths[index].latitude;\r\n            dLon2 = paths[0].longitude;\r\n            dLat2 = paths[0].latitude;\r\n        }\r\n        else {\r\n            dLon1 = paths[index].longitude;\r\n            dLat1 = paths[index].latitude;\r\n            dLon2 = paths[index + 1].longitude;\r\n            dLat2 = paths[index + 1].latitude;\r\n        }\r\n\r\n        if (((y >= dLat1) && (y < dLat2)) || ((y >= dLat2) && (y < dLat1))) {\r\n            if (Math.abs(dLat1 - dLat2) > 0) {\r\n                dLon = dLon1 - ((dLon1 - dLon2) * (dLat1 - y)) / (dLat1 - dLat2);\r\n                if (dLon < x)\r\n                    isum++;\r\n            }\r\n        }\r\n    }\r\n\r\n    return (isum % 2) !== 0;\r\n}\r\n\r\n","/**\r\n * Created by thomas on 9/01/14.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * (c) www.geocento.com\r\n * www.metaaps.com\r\n * <pre>\r\n *      update:\r\n *          2018-9-17:\r\n *              - pickStrategy属性兼容性\r\n *              - 适配stopDrawing在未开始标绘的情况\r\n *          2019-9-24:\r\n *              - 对属性带有modeType:billboard的entity加入setEditable(boolean)的方法,用于改变位置\r\n * </pre>\r\n *\r\n */\r\n(function webpackUniversalModuleDefinition(root, factory) {\r\n    if (typeof exports === 'object' && typeof module === 'object')\r\n        module.exports = factory(require('Cesium'));\r\n    else if (typeof define === 'function' && define.amd)\r\n        define('DrawHelper', ['Cesium'], factory);\r\n    else {\r\n        root.DrawHelper = factory(root.Cesium);\r\n    }\r\n}(window, function (Cesium) {\r\n    // static variables\r\n    var ellipsoid = Cesium.Ellipsoid.WGS84;\r\n\r\n    /**\r\n     *\r\n     * @param { Cesium.Cartesian2} position\r\n     * @param {Cesium.Viewer} viewer\r\n     * @return {Cesium.Cartesian3}\r\n     */\r\n    var defaultPickStrategy = function (position, viewer) {\r\n        return viewer.scene.camera.pickEllipsoid(position);\r\n    };\r\n\r\n    /**\r\n     * @constructor\r\n     * @param cesiumWidget\r\n     * @private\r\n     */\r\n    function _(cesiumWidget) {\r\n        this._viewer = cesiumWidget;\r\n        this._scene = cesiumWidget.scene;\r\n        this._tooltip = createTooltip(cesiumWidget.container);\r\n        this._surfaces = [];\r\n        //适配\r\n        (Cesium.defined(Cesium.ContextLimits)) && (\r\n            Cesium.ContextLimits._maximumAliasedLineWidth = 10);\r\n\r\n        this.initialiseHandlers();\r\n\r\n        this.enhancePrimitives();\r\n        enhanceWithListeners(this);\r\n    }\r\n\r\n    _.prototype.initialiseHandlers = function () {\r\n        var scene = this._scene;\r\n        var _self = this;\r\n        // scene events\r\n        var handler = new Cesium.ScreenSpaceEventHandler(scene.canvas);\r\n\r\n        function callPrimitiveCallback(name, position) {\r\n            if (_self._handlersMuted == true) return;\r\n            var pickedObject = scene.pick(position);\r\n            if (pickedObject && pickedObject.primitive && pickedObject.primitive[name]) {\r\n                pickedObject.primitive[name](position);\r\n            }\r\n            if (pickedObject && pickedObject.id && pickedObject.id.constructor.toString().match(/^function\\s*([^\\s(]+)/)[1] === \"Entity\" && pickedObject.id[name]){\r\n                pickedObject.id[name](position);\r\n            }\r\n         }\r\n\r\n        handler.setInputAction(\r\n            function (movement) {\r\n                callPrimitiveCallback('leftClick', movement.position);\r\n            }, Cesium.ScreenSpaceEventType.LEFT_CLICK);\r\n        handler.setInputAction(\r\n            function (movement) {\r\n                callPrimitiveCallback('leftDoubleClick', movement.position);\r\n            }, Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK);\r\n        var mouseOutObject;\r\n        handler.setInputAction(\r\n            function (movement) {\r\n                if (_self._handlersMuted == true) return;\r\n                var pickedObject = scene.pick(movement.endPosition);\r\n                if (mouseOutObject && (!pickedObject || mouseOutObject != pickedObject.primitive)) {\r\n                    !(mouseOutObject.isDestroyed && mouseOutObject.isDestroyed()) && mouseOutObject.mouseOut(movement.endPosition);\r\n                    mouseOutObject = null;\r\n                }\r\n                if (pickedObject && pickedObject.primitive) {\r\n                    pickedObject = pickedObject.primitive;\r\n                    if (pickedObject.mouseOut) {\r\n                        mouseOutObject = pickedObject;\r\n                    }\r\n                    if (pickedObject.mouseMove) {\r\n                        pickedObject.mouseMove(movement.endPosition);\r\n                    }\r\n                }\r\n            }, Cesium.ScreenSpaceEventType.MOUSE_MOVE);\r\n        handler.setInputAction(\r\n            function (movement) {\r\n                callPrimitiveCallback('leftUp', movement.position);\r\n            }, Cesium.ScreenSpaceEventType.LEFT_UP);\r\n        handler.setInputAction(\r\n            function (movement) {\r\n                callPrimitiveCallback('leftDown', movement.position);\r\n            }, Cesium.ScreenSpaceEventType.LEFT_DOWN);\r\n    }\r\n\r\n    _.prototype.setListener = function (primitive, type, callback) {\r\n        primitive[type] = callback;\r\n    }\r\n\r\n    _.prototype.muteHandlers = function (muted) {\r\n        this._handlersMuted = muted;\r\n    }\r\n\r\n    // register event handling for an editable shape\r\n    // shape should implement setEditMode and setHighlighted\r\n    _.prototype.registerEditableShape = function (surface) {\r\n        var _self = this;\r\n\r\n        // handlers for interactions\r\n        // highlight polygon when mouse is entering\r\n        setListener(surface, 'mouseMove', function (position) {\r\n            surface.setHighlighted(true);\r\n            if (!surface._editMode) {\r\n                _self._tooltip.showAt(position, \"Click to edit this shape\");\r\n            }\r\n        });\r\n        // hide the highlighting when mouse is leaving the polygon\r\n        setListener(surface, 'mouseOut', function (position) {\r\n            surface.setHighlighted(false);\r\n            _self._tooltip.setVisible(false);\r\n        });\r\n        setListener(surface, 'leftClick', function (position) {\r\n            surface.setEditMode(true);\r\n        });\r\n    }\r\n\r\n    _.prototype.startDrawing = function (cleanUp) {\r\n        // undo any current edit of shapes\r\n        this.disableAllEditMode();\r\n        // check for cleanUp first\r\n        if (this.editCleanUp) {\r\n            this.editCleanUp();\r\n        }\r\n        this.editCleanUp = cleanUp;\r\n        this.muteHandlers(true);\r\n    }\r\n\r\n    _.prototype.stopDrawing = function () {\r\n        // check for cleanUp first\r\n        if (this.editCleanUp) {\r\n            this.editCleanUp();\r\n            this.editCleanUp = null;\r\n        }\r\n        this.muteHandlers(false);\r\n    }\r\n\r\n    // make sure only one shape is highlighted at a time\r\n    _.prototype.disableAllHighlights = function () {\r\n        this.setHighlighted(undefined);\r\n    }\r\n\r\n    _.prototype.setHighlighted = function (surface) {\r\n        if (this._highlightedSurface && !this._highlightedSurface.isDestroyed() && this._highlightedSurface != surface) {\r\n            this._highlightedSurface.setHighlighted(false);\r\n        }\r\n        this._highlightedSurface = surface;\r\n    }\r\n\r\n    _.prototype.disableAllEditMode = function () {\r\n        this.setEdited(undefined);\r\n    }\r\n\r\n    _.prototype.setEdited = function (surface) {\r\n        if (this._editedSurface && !this._editedSurface.isDestroyed()) {\r\n            this._editedSurface.setEditMode(false);\r\n        }\r\n        this._editedSurface = surface;\r\n    }\r\n\r\n    var material = Cesium.Material.fromType(Cesium.Material.ColorType);\r\n    material.uniforms.color = new Cesium.Color(1.0, 1.0, 0.0, 0.5);\r\n\r\n    var defaultShapeOptions = {\r\n        ellipsoid: Cesium.Ellipsoid.WGS84,\r\n        textureRotationAngle: 0.0,\r\n        height: 0.0,\r\n        asynchronous: true,\r\n        show: true,\r\n        debugShowBoundingVolume: false,\r\n        strategy: {\r\n            pickStrategy: defaultPickStrategy\r\n        }\r\n    }\r\n\r\n    var defaultSurfaceOptions = copyOptions(defaultShapeOptions, {\r\n        appearance: new Cesium.EllipsoidSurfaceAppearance({\r\n            aboveGround: false\r\n        }),\r\n        material: material,\r\n        granularity: Math.PI / 180.0,\r\n        strategy: {\r\n            pickStrategy: defaultPickStrategy\r\n        }\r\n    });\r\n\r\n    var defaultPolygonOptions = copyOptions(defaultShapeOptions, {});\r\n    var defaultExtentOptions = copyOptions(defaultShapeOptions, {});\r\n    var defaultCircleOptions = copyOptions(defaultShapeOptions, {});\r\n    var defaultEllipseOptions = copyOptions(defaultSurfaceOptions, {rotation: 0});\r\n\r\n    var defaultPolylineOptions = copyOptions(defaultShapeOptions, {\r\n        width: 5,\r\n        geodesic: true,\r\n        granularity: 10000,\r\n        appearance: new Cesium.PolylineMaterialAppearance({\r\n            aboveGround: false\r\n        }),\r\n        material: material\r\n    });\r\n\r\n\r\n//    Cesium.Polygon.prototype.setStrokeStyle = setStrokeStyle;\r\n//\r\n//    Cesium.Polygon.prototype.drawOutline = drawOutline;\r\n//\r\n\r\n    var ChangeablePrimitive = (function () {\r\n        function _() {\r\n        }\r\n\r\n        _.prototype.initialiseOptions = function (options) {\r\n\r\n            fillOptions(this, options);\r\n\r\n            this._ellipsoid = undefined;\r\n            this._granularity = undefined;\r\n            this._height = undefined;\r\n            this._textureRotationAngle = undefined;\r\n            this._id = undefined;\r\n\r\n            // set the flags to initiate a first drawing\r\n            this._createPrimitive = true;\r\n            this._primitive = undefined;\r\n            this._outlinePolygon = undefined;\r\n\r\n        }\r\n\r\n        _.prototype.setAttribute = function (name, value) {\r\n            this[name] = value;\r\n            this._createPrimitive = true;\r\n        };\r\n\r\n        _.prototype.getAttribute = function (name) {\r\n            return this[name];\r\n        };\r\n\r\n        /**\r\n         * @private\r\n         */\r\n        _.prototype.update = function (context, frameState, commandList) {\r\n\r\n            if (!Cesium.defined(this.ellipsoid)) {\r\n                throw new Cesium.DeveloperError('this.ellipsoid must be defined.');\r\n            }\r\n\r\n            if (!Cesium.defined(this.appearance)) {\r\n                throw new Cesium.DeveloperError('this.material must be defined.');\r\n            }\r\n\r\n            if (this.granularity < 0.0) {\r\n                throw new Cesium.DeveloperError('this.granularity and scene2D/scene3D overrides must be greater than zero.');\r\n            }\r\n\r\n            if (!this.show) {\r\n                return;\r\n            }\r\n\r\n            if (!this._createPrimitive && (!Cesium.defined(this._primitive))) {\r\n                // No positions/hierarchy to draw\r\n                return;\r\n            }\r\n\r\n            if (this._createPrimitive ||\r\n                (this._ellipsoid !== this.ellipsoid) ||\r\n                (this._granularity !== this.granularity) ||\r\n                (this._height !== this.height) ||\r\n                (this._textureRotationAngle !== this.textureRotationAngle) ||\r\n                (this._id !== this.id)) {\r\n\r\n                var geometry = this.getGeometry();\r\n                if (!geometry) {\r\n                    return;\r\n                }\r\n\r\n                this._createPrimitive = false;\r\n                this._ellipsoid = this.ellipsoid;\r\n                this._granularity = this.granularity;\r\n                this._height = this.height;\r\n                this._textureRotationAngle = this.textureRotationAngle;\r\n                this._id = this.id;\r\n\r\n                this._primitive = this._primitive && this._primitive.destroy();\r\n                var me = this;\r\n                this._primitive = new Cesium.Primitive({\r\n                    geometryInstances: new Cesium.GeometryInstance({\r\n                        geometry: geometry,\r\n                        id: this.id,\r\n                        pickPrimitive: this\r\n                    }),\r\n                    appearance: this.appearance,\r\n                    asynchronous: this.asynchronous\r\n                });\r\n                // this._primitive = new Cesium.GroundPrimitive({\r\n                //     geometryInstances: new Cesium.GeometryInstance({\r\n                //         geometry: geometry,\r\n                //         id: me.id,\r\n                //         pickPrimitive: me\r\n                //     }),\r\n                //     attributes: {\r\n                //         // color :  Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.BLUE.withAlpha(0.5))\r\n                //         color: Cesium.ColorGeometryInstanceAttribute.fromColor(this.strokeColor)\r\n                //     }\r\n                // });\r\n\r\n                this._outlinePolygon = this._outlinePolygon && this._outlinePolygon.destroy();\r\n                if (this.strokeColor && this.getOutlineGeometry) {\r\n                    // create the highlighting frame\r\n                    this._outlinePolygon = new Cesium.Primitive({\r\n                        geometryInstances: new Cesium.GeometryInstance({\r\n                            geometry: this.getOutlineGeometry(),\r\n                            attributes: {\r\n                                color: Cesium.ColorGeometryInstanceAttribute.fromColor(this.strokeColor)\r\n                            }\r\n                        }),\r\n                        appearance: new Cesium.PerInstanceColorAppearance({\r\n                            flat: true,\r\n                            renderState: {\r\n                                depthTest: {\r\n                                    enabled: true\r\n                                },\r\n                                lineWidth: Math.min(this.strokeWidth || 4.0)\r\n                            }\r\n                        })\r\n                    });\r\n                }\r\n            }\r\n\r\n            var primitive = this._primitive;\r\n            // primitive.appearance.material = this.material;\r\n            // primitive.appearance = this.appearance;\r\n            primitive.appearance.material = this.material;\r\n            // primitive.debugShowBoundingVolume = this.debugShowBoundingVolume;\r\n            primitive.update(context, frameState, commandList);\r\n            //debug\r\n            // console.log(context)\r\n            // console.log(frameState)\r\n            // console.log(commandList)\r\n            this._outlinePolygon && this._outlinePolygon.update(context, frameState, commandList);\r\n\r\n        };\r\n\r\n        _.prototype.isDestroyed = function () {\r\n            return false;\r\n        };\r\n\r\n        _.prototype.destroy = function () {\r\n            this._primitive = this._primitive && this._primitive.destroy();\r\n            return Cesium.destroyObject(this);\r\n        };\r\n\r\n        _.prototype.setStrokeStyle = function (strokeColor, strokeWidth) {\r\n            if (!this.strokeColor || !this.strokeColor.equals(strokeColor) || this.strokeWidth != strokeWidth) {\r\n                this._createPrimitive = true;\r\n                this.strokeColor = strokeColor;\r\n                this.strokeWidth = strokeWidth;\r\n            }\r\n        }\r\n\r\n        return _;\r\n    })();\r\n\r\n    _.ExtentPrimitive = (function () {\r\n        function _(options) {\r\n\r\n            if (!Cesium.defined(options.extent)) {\r\n                throw new Cesium.DeveloperError('Extent is required');\r\n            }\r\n\r\n            options = copyOptions(options, defaultSurfaceOptions);\r\n\r\n            this.initialiseOptions(options);\r\n\r\n            this.setExtent(options.extent);\r\n\r\n        }\r\n\r\n        _.prototype = new ChangeablePrimitive();\r\n\r\n        _.prototype.setExtent = function (extent) {\r\n            this.setAttribute('extent', extent);\r\n        };\r\n\r\n        _.prototype.getExtent = function () {\r\n            return this.getAttribute('extent');\r\n        };\r\n\r\n        _.prototype.getGeometry = function () {\r\n\r\n            if (!Cesium.defined(this.extent)) {\r\n                return;\r\n            }\r\n\r\n            return new Cesium.RectangleGeometry({\r\n                rectangle: this.extent,\r\n                height: this.height,\r\n                vertexFormat: Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,\r\n                stRotation: this.textureRotationAngle,\r\n                ellipsoid: this.ellipsoid,\r\n                granularity: this.granularity\r\n            });\r\n        };\r\n\r\n        _.prototype.getOutlineGeometry = function () {\r\n            return new Cesium.RectangleOutlineGeometry({\r\n                rectangle: this.extent\r\n            });\r\n        }\r\n\r\n        return _;\r\n    })();\r\n\r\n    _.PolygonPrimitive = (function () {\r\n\r\n        function _(options) {\r\n\r\n            options = copyOptions(options, defaultSurfaceOptions);\r\n\r\n            this.initialiseOptions(options);\r\n\r\n            this.isPolygon = true;\r\n\r\n        }\r\n\r\n        _.prototype = new ChangeablePrimitive();\r\n\r\n        _.prototype.setPositions = function (positions) {\r\n            this.setAttribute('positions', positions);\r\n        };\r\n\r\n        _.prototype.getPositions = function () {\r\n            return this.getAttribute('positions');\r\n        };\r\n\r\n        _.prototype.getGeometry = function () {\r\n\r\n            if (!Cesium.defined(this.positions) || this.positions.length < 3) {\r\n                return;\r\n            }\r\n\r\n            return Cesium.PolygonGeometry.fromPositions({\r\n                positions: this.positions,\r\n                height: this.height,\r\n                vertexFormat: Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,\r\n                stRotation: this.textureRotationAngle,\r\n                ellipsoid: this.ellipsoid,\r\n                granularity: this.granularity\r\n            });\r\n        };\r\n\r\n        _.prototype.getOutlineGeometry = function () {\r\n            return Cesium.PolygonOutlineGeometry.fromPositions({\r\n                positions: this.getPositions()\r\n            });\r\n        }\r\n\r\n        return _;\r\n    })();\r\n\r\n    _.CirclePrimitive = (function () {\r\n\r\n        function _(options) {\r\n\r\n            if (!(Cesium.defined(options.center) && Cesium.defined(options.radius))) {\r\n                throw new Cesium.DeveloperError('Center and radius are required');\r\n            }\r\n\r\n            options = copyOptions(options, defaultSurfaceOptions);\r\n\r\n            this.initialiseOptions(options);\r\n\r\n            this.setRadius(options.radius);\r\n\r\n        }\r\n\r\n        _.prototype = new ChangeablePrimitive();\r\n\r\n        _.prototype.setCenter = function (center) {\r\n            this.setAttribute('center', center);\r\n        };\r\n\r\n        _.prototype.setRadius = function (radius) {\r\n            this.setAttribute('radius', Math.max(0.1, radius));\r\n        };\r\n\r\n        _.prototype.getCenter = function () {\r\n            return this.getAttribute('center');\r\n        };\r\n\r\n        _.prototype.getRadius = function () {\r\n            return this.getAttribute('radius');\r\n        };\r\n\r\n        _.prototype.getGeometry = function () {\r\n\r\n            if (!(Cesium.defined(this.center) && Cesium.defined(this.radius))) {\r\n                return;\r\n            }\r\n\r\n            return new Cesium.CircleGeometry({\r\n                center: this.center,\r\n                radius: this.radius,\r\n                height: this.height,\r\n                vertexFormat: Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,\r\n                stRotation: this.textureRotationAngle,\r\n                ellipsoid: this.ellipsoid,\r\n                granularity: this.granularity\r\n            });\r\n        };\r\n\r\n        _.prototype.getOutlineGeometry = function () {\r\n            return new Cesium.CircleOutlineGeometry({\r\n                center: this.getCenter(),\r\n                radius: this.getRadius()\r\n            });\r\n        }\r\n\r\n        return _;\r\n    })();\r\n\r\n    _.EllipsePrimitive = (function () {\r\n        function _(options) {\r\n\r\n            if (!(Cesium.defined(options.center) && Cesium.defined(options.semiMajorAxis) && Cesium.defined(options.semiMinorAxis))) {\r\n                throw new Cesium.DeveloperError('Center and semi major and semi minor axis are required');\r\n            }\r\n\r\n            options = copyOptions(options, defaultEllipseOptions);\r\n\r\n            this.initialiseOptions(options);\r\n\r\n        }\r\n\r\n        _.prototype = new ChangeablePrimitive();\r\n\r\n        _.prototype.setCenter = function (center) {\r\n            this.setAttribute('center', center);\r\n        };\r\n\r\n        _.prototype.setSemiMajorAxis = function (semiMajorAxis) {\r\n            if (semiMajorAxis < this.getSemiMinorAxis()) return;\r\n            this.setAttribute('semiMajorAxis', semiMajorAxis);\r\n        };\r\n\r\n        _.prototype.setSemiMinorAxis = function (semiMinorAxis) {\r\n            if (semiMinorAxis > this.getSemiMajorAxis()) return;\r\n            this.setAttribute('semiMinorAxis', semiMinorAxis);\r\n        };\r\n\r\n        _.prototype.setRotation = function (rotation) {\r\n            return this.setAttribute('rotation', rotation);\r\n        };\r\n\r\n        _.prototype.getCenter = function () {\r\n            return this.getAttribute('center');\r\n        };\r\n\r\n        _.prototype.getSemiMajorAxis = function () {\r\n            return this.getAttribute('semiMajorAxis');\r\n        };\r\n\r\n        _.prototype.getSemiMinorAxis = function () {\r\n            return this.getAttribute('semiMinorAxis');\r\n        };\r\n\r\n        _.prototype.getRotation = function () {\r\n            return this.getAttribute('rotation');\r\n        };\r\n\r\n        _.prototype.getGeometry = function () {\r\n\r\n            if (!(Cesium.defined(this.center) && Cesium.defined(this.semiMajorAxis) && Cesium.defined(this.semiMinorAxis))) {\r\n                return;\r\n            }\r\n\r\n            return new Cesium.EllipseGeometry({\r\n                ellipsoid: this.ellipsoid,\r\n                center: this.center,\r\n                semiMajorAxis: this.semiMajorAxis,\r\n                semiMinorAxis: this.semiMinorAxis,\r\n                rotation: this.rotation,\r\n                height: this.height,\r\n                vertexFormat: Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,\r\n                stRotation: this.textureRotationAngle,\r\n                ellipsoid: this.ellipsoid,\r\n                granularity: this.granularity\r\n            });\r\n        };\r\n\r\n        _.prototype.getOutlineGeometry = function () {\r\n            return new Cesium.EllipseOutlineGeometry({\r\n                center: this.getCenter(),\r\n                semiMajorAxis: this.getSemiMajorAxis(),\r\n                semiMinorAxis: this.getSemiMinorAxis(),\r\n                rotation: this.getRotation()\r\n            });\r\n        }\r\n\r\n        return _;\r\n    })();\r\n\r\n    _.PolylinePrimitive = (function () {\r\n\r\n        function _(options) {\r\n\r\n            options = copyOptions(options, defaultPolylineOptions);\r\n\r\n            this.initialiseOptions(options);\r\n\r\n        }\r\n\r\n        _.prototype = new ChangeablePrimitive();\r\n\r\n        _.prototype.setPositions = function (positions) {\r\n            this.setAttribute('positions', positions);\r\n        };\r\n\r\n        _.prototype.setWidth = function (width) {\r\n            this.setAttribute('width', width);\r\n        };\r\n\r\n        _.prototype.setGeodesic = function (geodesic) {\r\n            this.setAttribute('geodesic', geodesic);\r\n        };\r\n\r\n        _.prototype.getPositions = function () {\r\n            return this.getAttribute('positions');\r\n        };\r\n\r\n        _.prototype.getWidth = function () {\r\n            return this.getAttribute('width');\r\n        };\r\n\r\n        _.prototype.getGeodesic = function (geodesic) {\r\n            return this.getAttribute('geodesic');\r\n        };\r\n\r\n        _.prototype.getGeometry = function () {\r\n\r\n            if (!Cesium.defined(this.positions) || this.positions.length < 2) {\r\n                return;\r\n            }\r\n\r\n            return new Cesium.PolylineGeometry({\r\n                positions: this.positions,\r\n                height: this.height,\r\n                width: this.width < 1 ? 1 : this.width,\r\n                vertexFormat: Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,\r\n                ellipsoid: this.ellipsoid\r\n            });\r\n        }\r\n\r\n        return _;\r\n    })();\r\n\r\n\r\n    var defaultBillboard = {\r\n        iconUrl: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAYAAACprHcmAAABbElEQVQoU2NkIAEwwtR6enqyc3Jy6jEzMyv9//+fl5GR8fPfv3/vff/+/dL27dt/gtSBFYMUcnBwePj4+ARYW1u7cHFxiX/9+vXl0aNH92zdunXDjx8/doA0gBV7eXmZ+/r6Zjo4OMR+//6dCWYbOzv7v3379i3evn379G3btp0EK3Z3d49tampq//79u/T///8Zfv36xfD792+Gf//+MbCwsDydOHFi5c6dOxeDFTs5OeV0dHT0vXr1ivXLl28Mf//+gXubjY3t9/Tp04r27ds3BazYysoqsaqqtuX7919S6IHz7dvXZzNnTqk5duzYfLBiY2NjG2dnt2w7O9ewf//+wd38/z/Dv717t686evTA1LNnzx4BK3ZwcOB49epViKOju7+NjYsNHx+/yKdPH94cPrz3yIEDOzeKiYmtOXDgwA94OMvIyHB+//7d+v///7oMDAwCDAwMHxgZGS9zcnIeffLkyXd4OBMbiQDHU6AM+91hMQAAAABJRU5ErkJggg==\",\r\n        shiftX: 0,\r\n        shiftY: 0,\r\n        strategy: {\r\n            pickStrategy: defaultPickStrategy\r\n        }\r\n    }\r\n\r\n    var dragBillboard = {\r\n        iconUrl: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAYAAACprHcmAAABbElEQVQoU2NkIAEwwtR6enqyc3Jy6jEzMyv9//+fl5GR8fPfv3/vff/+/dL27dt/gtSBFYMUcnBwePj4+ARYW1u7cHFxiX/9+vXl0aNH92zdunXDjx8/doA0gBV7eXmZ+/r6Zjo4OMR+//6dCWYbOzv7v3379i3evn379G3btp0EK3Z3d49tampq//79u/T///8Zfv36xfD792+Gf//+MbCwsDydOHFi5c6dOxeDFTs5OeV0dHT0vXr1ivXLl28Mf//+gXubjY3t9/Tp04r27ds3BazYysoqsaqqtuX7919S6IHz7dvXZzNnTqk5duzYfLBiY2NjG2dnt2w7O9ewf//+wd38/z/Dv717t686evTA1LNnzx4BK3ZwcOB49epViKOju7+NjYsNHx+/yKdPH94cPrz3yIEDOzeKiYmtOXDgwA94OMvIyHB+//7d+v///7oMDAwCDAwMHxgZGS9zcnIeffLkyXd4OBMbiQDHU6AM+91hMQAAAABJRU5ErkJggg==\",\r\n        shiftX: 0,\r\n        shiftY: 0\r\n    }\r\n\r\n    var dragHalfBillboard = {\r\n        iconUrl: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAYAAACprHcmAAABCklEQVQoU5XRMUiEcBTH8e8/iBQMAoXAULBRqTWwGxvaagi3GxqjpragMWhrKhobbpOG2hoaL6G18MYTlIRAIUjQCDKU7mhwqDd/Hvze7wn+MWJi67qeA1aBZWAeeAfGwJMQ4qNxLf6Bm8A2sAEsAq/APXAD3DULE7wG7AF9YOZXsi9gAFwKIR5bXJZlX5KkU2Cp44SXqqqOZFketDjLsgNVVc+A2Q78mef5oaZp5y2O43jXMIwTQO/AaZIkx6ZpXrU4DMOebdv7gNeR2R+NRheO4wxbHEWRlKbpjuu6W0AP0Jp0wDAIgltd168ty6qmPfu+LxdFsQ6sAAvAG/CsKMqD53nltOe/PvEbmPRTDApQ3d8AAAAASUVORK5CYII=\",\r\n        shiftX: 0,\r\n        shiftY: 0\r\n    }\r\n\r\n    _.prototype.createBillboardGroup = function (points, options, callbacks) {\r\n        var markers = new _.BillboardGroup(this, options);\r\n        markers.addBillboards(points, callbacks);\r\n        return markers;\r\n    }\r\n\r\n    _.BillboardGroup = function (drawHelper, options) {\r\n\r\n        this._drawHelper = drawHelper;\r\n        this._scene = drawHelper._scene;\r\n\r\n        this._options = copyOptions(options, defaultBillboard);\r\n\r\n        // create one common billboard collection for all billboards\r\n        var b = new Cesium.BillboardCollection();\r\n        this._scene.primitives.add(b);\r\n        this._billboards = b;\r\n        // keep an ordered list of billboards\r\n        this._orderedBillboards = [];\r\n    }\r\n\r\n    _.BillboardGroup.prototype.createBillboard = function (position, callbacks) {\r\n\r\n        var billboard = this._billboards.add({\r\n            show: true,\r\n            position: position,\r\n            pixelOffset: new Cesium.Cartesian2(this._options.shiftX, this._options.shiftY),\r\n            eyeOffset: new Cesium.Cartesian3(0.0, 0.0, 0.0),\r\n            horizontalOrigin: Cesium.HorizontalOrigin.CENTER,\r\n            verticalOrigin: Cesium.VerticalOrigin.CENTER,\r\n            scale: 1.0,\r\n            image: this._options.iconUrl,\r\n            color: new Cesium.Color(1.0, 1.0, 1.0, 1.0)\r\n        });\r\n\r\n        // if editable\r\n        if (callbacks) {\r\n            var _self = this;\r\n            var screenSpaceCameraController = this._scene.screenSpaceCameraController;\r\n\r\n            function enableRotation(enable) {\r\n                screenSpaceCameraController.enableRotate = enable;\r\n            }\r\n\r\n            function getIndex() {\r\n                // find index\r\n                for (var i = 0, I = _self._orderedBillboards.length; i < I && _self._orderedBillboards[i] != billboard; ++i) ;\r\n                return i;\r\n            }\r\n\r\n            if (callbacks.dragHandlers) {\r\n                var _self = this;\r\n                setListener(billboard, 'leftDown', function (position) {\r\n                    // TODO - start the drag handlers here\r\n                    // create handlers for mouseOut and leftUp for the billboard and a mouseMove\r\n                    function onDrag(position) {\r\n                        billboard.position = position;\r\n                        // find index\r\n                        for (var i = 0, I = _self._orderedBillboards.length; i < I && _self._orderedBillboards[i] != billboard; ++i) ;\r\n                        callbacks.dragHandlers.onDrag && callbacks.dragHandlers.onDrag(getIndex(), position);\r\n                    }\r\n\r\n                    function onDragEnd(position) {\r\n                        handler.destroy();\r\n                        enableRotation(true);\r\n                        callbacks.dragHandlers.onDragEnd && callbacks.dragHandlers.onDragEnd(getIndex(), position);\r\n                    }\r\n\r\n                    var handler = new Cesium.ScreenSpaceEventHandler(_self._scene.canvas);\r\n\r\n                    handler.setInputAction(function (movement) {\r\n                        var cartesian = _self._scene.camera.pickEllipsoid(movement.endPosition, ellipsoid);\r\n                        if (cartesian) {\r\n                            onDrag(cartesian);\r\n                        } else {\r\n                            onDragEnd(cartesian);\r\n                        }\r\n                    }, Cesium.ScreenSpaceEventType.MOUSE_MOVE);\r\n\r\n                    handler.setInputAction(function (movement) {\r\n                        onDragEnd(_self._scene.camera.pickEllipsoid(movement.position, ellipsoid));\r\n                    }, Cesium.ScreenSpaceEventType.LEFT_UP);\r\n\r\n                    enableRotation(false);\r\n\r\n                    callbacks.dragHandlers.onDragStart && callbacks.dragHandlers.onDragStart(getIndex(), _self._scene.camera.pickEllipsoid(position, ellipsoid));\r\n                });\r\n            }\r\n            if (callbacks.onDoubleClick) {\r\n                setListener(billboard, 'leftDoubleClick', function (position) {\r\n                    callbacks.onDoubleClick(getIndex());\r\n                });\r\n            }\r\n            if (callbacks.onClick) {\r\n                setListener(billboard, 'leftClick', function (position) {\r\n                    callbacks.onClick(getIndex());\r\n                });\r\n            }\r\n            if (callbacks.tooltip) {\r\n                setListener(billboard, 'mouseMove', function (position) {\r\n                    _self._drawHelper._tooltip.showAt(position, callbacks.tooltip());\r\n                });\r\n                setListener(billboard, 'mouseOut', function (position) {\r\n                    _self._drawHelper._tooltip.setVisible(false);\r\n                });\r\n            }\r\n        }\r\n\r\n        return billboard;\r\n    }\r\n\r\n    _.BillboardGroup.prototype.insertBillboard = function (index, position, callbacks) {\r\n        this._orderedBillboards.splice(index, 0, this.createBillboard(position, callbacks));\r\n    }\r\n\r\n    _.BillboardGroup.prototype.addBillboard = function (position, callbacks) {\r\n        this._orderedBillboards.push(this.createBillboard(position, callbacks));\r\n    }\r\n\r\n    _.BillboardGroup.prototype.addBillboards = function (positions, callbacks) {\r\n        var index = 0;\r\n        for (; index < positions.length; index++) {\r\n            this.addBillboard(positions[index], callbacks);\r\n        }\r\n    }\r\n\r\n    _.BillboardGroup.prototype.updateBillboardsPositions = function (positions) {\r\n        var index = 0;\r\n        for (; index < positions.length; index++) {\r\n            this.getBillboard(index).position = positions[index];\r\n        }\r\n    }\r\n\r\n    _.BillboardGroup.prototype.countBillboards = function () {\r\n        return this._orderedBillboards.length;\r\n    }\r\n\r\n    _.BillboardGroup.prototype.getBillboard = function (index) {\r\n        return this._orderedBillboards[index];\r\n    }\r\n\r\n    _.BillboardGroup.prototype.removeBillboard = function (index) {\r\n        this._billboards.remove(this.getBillboard(index));\r\n        this._orderedBillboards.splice(index, 1);\r\n    }\r\n\r\n    _.BillboardGroup.prototype.remove = function () {\r\n        this._billboards = this._billboards && this._billboards.removeAll() && this._billboards.destroy();\r\n    }\r\n\r\n    _.BillboardGroup.prototype.setOnTop = function () {\r\n        this._scene.primitives.raiseToTop(this._billboards);\r\n    }\r\n\r\n    _.prototype.startDrawingMarker = function (options) {\r\n\r\n        var options = copyOptions(options, defaultBillboard);\r\n\r\n        this.startDrawing(\r\n            function () {\r\n                markers && markers.remove();\r\n                mouseHandler && mouseHandler.destroy();\r\n                tooltip && tooltip.setVisible(false);\r\n            }\r\n        );\r\n\r\n        var _self = this;\r\n        var scene = this._scene;\r\n        var viewer = this._viewer;\r\n\r\n        var primitives = scene.primitives;\r\n        var tooltip = this._tooltip;\r\n\r\n        var markers = new _.BillboardGroup(this, options);\r\n\r\n        var mouseHandler = new Cesium.ScreenSpaceEventHandler(scene.canvas);\r\n\r\n        // Now wait for start\r\n        mouseHandler.setInputAction(function (movement) {\r\n            if (movement.position != null) {\r\n                // var cartesian = scene.camera.pickEllipsoid(movement.position, ellipsoid);\r\n                var cartesian = options.strategy.pickStrategy(movement.position, viewer);\r\n                if (cartesian) {\r\n                    markers.addBillboard(cartesian);\r\n                    _self.stopDrawing();\r\n                    options.callback(cartesian, _self);\r\n                }\r\n            }\r\n        }, Cesium.ScreenSpaceEventType.LEFT_CLICK);\r\n\r\n        mouseHandler.setInputAction(function (movement) {\r\n            var position = movement.endPosition;\r\n            if (position != null) {\r\n                // var cartesian = scene.camera.pickEllipsoid(position, ellipsoid);\r\n                var cartesian = options.strategy.pickStrategy(position, viewer);\r\n                if (cartesian) {\r\n                    tooltip.showAt(position, \"<p>Click to add your marker. Position is: </p>\" + getDisplayLatLngString(ellipsoid.cartesianToCartographic(cartesian)));\r\n                } else {\r\n                    tooltip.showAt(position, \"<p>Click on the globe to add your marker.</p>\");\r\n                }\r\n            }\r\n        }, Cesium.ScreenSpaceEventType.MOUSE_MOVE);\r\n\r\n    }\r\n\r\n    _.prototype.startDrawingPolygon = function (options) {\r\n        // var options = copyOptions(options, defaultSurfaceOptions);\r\n        this.startDrawingPolyshape(true, options);\r\n    }\r\n\r\n    _.prototype.startDrawingPolyline = function (options) {\r\n        // var options = copyOptions(options, defaultPolylineOptions);\r\n        this.startDrawingPolyshape(false, options);\r\n    }\r\n\r\n    _.prototype.startDrawingPolyshape = function (isPolygon, options) {\r\n        options = isPolygon ? copyOptions(options, defaultSurfaceOptions) : copyOptions(options, defaultPolylineOptions);\r\n\r\n        this.startDrawing(\r\n            function () {\r\n                primitives && primitives.remove(poly);\r\n                markers && markers.remove();\r\n                mouseHandler && mouseHandler.destroy();\r\n                tooltip && tooltip.setVisible(false);\r\n            }\r\n        );\r\n\r\n        var _self = this;\r\n        var scene = this._scene;\r\n        var viewer = this._viewer;\r\n        var primitives = scene.primitives;\r\n        var tooltip = this._tooltip;\r\n\r\n        var minPoints = isPolygon ? 3 : 2;\r\n        var poly;\r\n        if (isPolygon) {\r\n            poly = new _.PolygonPrimitive(options);\r\n        } else {\r\n            poly = new _.PolylinePrimitive(options);\r\n        }\r\n        poly.asynchronous = false;\r\n        primitives.add(poly);\r\n\r\n        var positions = [];\r\n        var markers = new _.BillboardGroup(this, defaultBillboard);\r\n\r\n        var mouseHandler = new Cesium.ScreenSpaceEventHandler(scene.canvas);\r\n\r\n\r\n        mouseHandler.setInputAction(function (movement) {\r\n\r\n            var position = movement.position;\r\n            if (position != null) {\r\n                if (positions.length < minPoints /*+ 2*/) {\r\n                    return;\r\n                } else {\r\n                    // var cartesian = scene.camera.pickEllipsoid(position, ellipsoid);\r\n                    var cartesian = options.strategy.pickStrategy(movement.position, viewer);\r\n\r\n                    if (cartesian) {\r\n                        _self.stopDrawing();\r\n                        if (typeof options.callback == 'function') {\r\n                            // remove overlapping ones\r\n                            var index = positions.length - 1;\r\n                            options.callback(positions, _self);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }, Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK);\r\n        // Now wait for start\r\n        mouseHandler.setInputAction(function (movement) {\r\n\r\n            var cartesian = options.strategy.pickStrategy(movement.position, viewer);\r\n            cartesian = getCesiumHightZero(cartesian);\r\n\r\n            if (movement.position != null) {\r\n                // var cartesian = scene.camera.pickEllipsoid(movement.position, ellipsoid);\r\n\r\n                if (cartesian) {\r\n                    // first click\r\n                    if (positions.length == 0) {\r\n                        positions.push(cartesian.clone());\r\n                        markers.addBillboard(positions[0]);\r\n                    }\r\n                    if (positions.length >= minPoints) {\r\n                        poly.positions = positions;\r\n                        poly._createPrimitive = true;\r\n                    }\r\n                    // add new point to polygon\r\n                    // this one will move with the mouse\r\n                    positions.push(cartesian);\r\n                    // add marker at the new position\r\n                    markers.addBillboard(cartesian);\r\n                }\r\n            }\r\n\r\n        }, Cesium.ScreenSpaceEventType.LEFT_CLICK);\r\n\r\n        mouseHandler.setInputAction(function (movement) {\r\n            var position = movement.endPosition;\r\n            if (position != null) {\r\n                if (positions.length == 0) {\r\n                    tooltip.showAt(position, \"<p>Click to add first point</p>\");\r\n                } else {\r\n                    // var cartesian = scene.camera.pickEllipsoid(position, ellipsoid);\r\n                    // var cartesian = scene.pickPosition(position);\r\n                    // cartesian = getCesiumHightZero(cartesian);\r\n                    var cartesian = options.strategy.pickStrategy(position, viewer);\r\n\r\n                    if (cartesian) {\r\n                        positions.pop();\r\n                        // make sure it is slightly different\r\n                        // cartesian.y += (1 + Math.random());\r\n                        cartesian.y += Cesium.Math.EPSILON7;\r\n                        positions.push(cartesian);\r\n                        if (positions.length >= minPoints) {\r\n                            poly.positions = positions;\r\n                            poly._createPrimitive = true;\r\n                        }\r\n                        // update marker\r\n                        markers.getBillboard(positions.length - 1).position = cartesian;\r\n                        // show tooltip\r\n                        tooltip.showAt(position, \"<p>Click to add new point (\" + positions.length + \")</p>\" + (positions.length > minPoints ? \"<p>Double click to finish drawing</p>\" : \"\"));\r\n                    }\r\n                }\r\n            }\r\n        }, Cesium.ScreenSpaceEventType.MOUSE_MOVE);\r\n\r\n\r\n    }\r\n\r\n    function getExtentCorners(value) {\r\n        return ellipsoid.cartographicArrayToCartesianArray([Cesium.Rectangle.northwest(value), Cesium.Rectangle.northeast(value), Cesium.Rectangle.southeast(value), Cesium.Rectangle.southwest(value)]);\r\n    }\r\n\r\n    _.prototype.startDrawingExtent = function (options) {\r\n\r\n        var options = copyOptions(options, defaultSurfaceOptions);\r\n\r\n        this.startDrawing(\r\n            function () {\r\n                if (extent != null) {\r\n                    primitives && primitives.remove(extent);\r\n                }\r\n                markers && markers.remove();\r\n                mouseHandler && mouseHandler.destroy();\r\n                tooltip && tooltip.setVisible(false);\r\n            }\r\n        );\r\n\r\n        var _self = this;\r\n        var scene = this._scene;\r\n        var viewer = this._viewer;\r\n        var primitives = this._scene.primitives;\r\n        var tooltip = this._tooltip;\r\n\r\n        var firstPoint = null;\r\n        var extent = null;\r\n        var markers = null;\r\n\r\n        var mouseHandler = new Cesium.ScreenSpaceEventHandler(scene.canvas);\r\n\r\n        function updateExtent(value) {\r\n            if (extent == null) {\r\n                extent = new _.ExtentPrimitive({extent: value, material: options.material,});\r\n                extent.asynchronous = false;\r\n                primitives.add(extent);\r\n            }\r\n            extent.setExtent(value);\r\n            extent.rectangle = value;\r\n            // update the markers\r\n            var corners = getExtentCorners(value);\r\n            // create if they do not yet exist\r\n            if (markers == null) {\r\n                markers = new _.BillboardGroup(_self, defaultBillboard);\r\n                markers.addBillboards(corners);\r\n            } else {\r\n                markers.updateBillboardsPositions(corners);\r\n            }\r\n        }\r\n\r\n        // Now wait for start\r\n        mouseHandler.setInputAction(function (movement) {\r\n            if (movement.position != null) {\r\n                // var cartesian = scene.camera.pickEllipsoid(movement.position, ellipsoid);\r\n                var cartesian = options.strategy.pickStrategy(movement.position, viewer);\r\n\r\n                if (cartesian) {\r\n                    if (extent == null) {\r\n                        // create the rectangle\r\n                        firstPoint = ellipsoid.cartesianToCartographic(cartesian);\r\n                        var value = getExtent(firstPoint, firstPoint);\r\n                        updateExtent(value);\r\n                    } else {\r\n                        _self.stopDrawing();\r\n                        if (typeof options.callback == 'function') {\r\n                            options.callback(getExtent(firstPoint, ellipsoid.cartesianToCartographic(cartesian), _self));\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }, Cesium.ScreenSpaceEventType.LEFT_DOWN);\r\n\r\n        mouseHandler.setInputAction(function (movement) {\r\n            var position = movement.endPosition;\r\n            if (position != null) {\r\n                if (extent == null) {\r\n                    tooltip.showAt(position, \"<p>Click to start drawing rectangle</p>\");\r\n                } else {\r\n                    // var cartesian = scene.camera.pickEllipsoid(position, ellipsoid);\r\n                    var cartesian = options.strategy.pickStrategy(position, viewer);\r\n\r\n                    if (cartesian) {\r\n                        var value = getExtent(firstPoint, ellipsoid.cartesianToCartographic(cartesian));\r\n                        updateExtent(value);\r\n                        tooltip.showAt(position, \"<p>Drag to change rectangle extent</p><p>Click again to finish drawing</p>\");\r\n                    }\r\n                }\r\n            }\r\n        }, Cesium.ScreenSpaceEventType.MOUSE_MOVE);\r\n\r\n    }\r\n\r\n    _.prototype.startDrawingCircle = function (options) {\r\n\r\n        var options = copyOptions(options, defaultSurfaceOptions);\r\n\r\n        this.startDrawing(\r\n            function cleanUp() {\r\n                if (circle != null) {\r\n                    primitives && primitives.remove(circle);\r\n                }\r\n                markers && markers.remove();\r\n                mouseHandler && mouseHandler.destroy();\r\n                tooltip && tooltip.setVisible(false);\r\n            }\r\n        );\r\n\r\n        var _self = this;\r\n        var scene = this._scene;\r\n        var viewer = this._viewer;\r\n        var primitives = this._scene.primitives;\r\n        var tooltip = this._tooltip;\r\n\r\n        var circle = null;\r\n        var markers = null;\r\n\r\n        var mouseHandler = new Cesium.ScreenSpaceEventHandler(scene.canvas);\r\n\r\n        function pickPosition(position) {\r\n            if (Cesium.defined(viewer.scene.pick(position))) {\r\n                return getCesiumHightZero(viewer.scene.pickPosition(position));\r\n            } else {\r\n                return getCesiumHightZero(viewer.scene.camera.pickEllipsoid(position))\r\n            }\r\n        }\r\n\r\n\r\n        // Now wait for start\r\n        mouseHandler.setInputAction(function (movement) {\r\n            if (movement.position != null) {\r\n                // var cartesian = scene.camera.pickEllipsoid(movement.position, ellipsoid);\r\n                // var cartesian = scene.pickPosition(movement.position);\r\n                // cartesian = getCesiumHightZero(cartesian);\r\n                // var cartesian = pickPosition(movement.position);\r\n                var cartesian = options.strategy.pickStrategy(movement.position, viewer);\r\n                if (cartesian) {\r\n                    if (circle == null) {\r\n                        // create the circle\r\n                        circle = new _.CirclePrimitive({\r\n                            center: cartesian,\r\n                            radius: 0,\r\n                            asynchronous: false,\r\n                            material: options.material\r\n                        });\r\n                        primitives.add(circle);\r\n                        markers = new _.BillboardGroup(_self, defaultBillboard);\r\n                        markers.addBillboards([cartesian]);\r\n                    } else {\r\n                        if (typeof options.callback == 'function') {\r\n                            options.callback(circle.getCenter(), circle.getRadius(), _self);\r\n                        }\r\n                        _self.stopDrawing();\r\n                    }\r\n                }\r\n            }\r\n        }, Cesium.ScreenSpaceEventType.LEFT_DOWN);\r\n\r\n        mouseHandler.setInputAction(function (movement) {\r\n            var position = movement.endPosition;\r\n            if (position != null) {\r\n                if (circle == null) {\r\n                    tooltip.showAt(position, \"<p>Click to start drawing the circle</p>\");\r\n                } else {\r\n                    // var cartesian = scene.camera.pickEllipsoid(position, ellipsoid);\r\n                    // var cartesian = scene.pickPosition(position);\r\n                    var cartesian = options.strategy.pickStrategy(position, viewer);\r\n\r\n                    if (cartesian) {\r\n                        // Cesium.Cartographic.fromCartesian(circle.getCenter())\r\n                        circle.setRadius(Cesium.Cartesian3.distance(getCesiumHightZero(circle.getCenter()), getCesiumHightZero(cartesian)));\r\n                        // circle.setRadius(Cesium.Cartesian3.distance(circle.getCenter(), cartesian));\r\n                        markers.updateBillboardsPositions(cartesian);\r\n                        tooltip.showAt(position, \"<p>Move mouse to change circle radius</p><p>Click again to finish drawing</p>\");\r\n                    }\r\n                }\r\n            }\r\n        }, Cesium.ScreenSpaceEventType.MOUSE_MOVE);\r\n\r\n    }\r\n\r\n    _.prototype.enhancePrimitives = function () {\r\n\r\n        var drawHelper = this;\r\n\r\n        Cesium.Billboard.prototype.setEditable = function () {\r\n\r\n            if (this._editable) {\r\n                return;\r\n            }\r\n\r\n            this._editable = true;\r\n\r\n            var billboard = this;\r\n\r\n            var _self = this;\r\n\r\n            function enableRotation(enable) {\r\n                drawHelper._scene.screenSpaceCameraController.enableRotate = enable;\r\n            }\r\n\r\n            setListener(billboard, 'leftDown', function (position) {\r\n                // TODO - start the drag handlers here\r\n                // create handlers for mouseOut and leftUp for the billboard and a mouseMove\r\n                function onDrag(position) {\r\n                    billboard.position = position;\r\n                    _self.executeListeners({name: 'drag', positions: position});\r\n                }\r\n\r\n                function onDragEnd(position) {\r\n                    handler.destroy();\r\n                    enableRotation(true);\r\n                    _self.executeListeners({name: 'dragEnd', positions: position});\r\n                }\r\n\r\n                var handler = new Cesium.ScreenSpaceEventHandler(drawHelper._scene.canvas);\r\n\r\n                handler.setInputAction(function (movement) {\r\n                    var cartesian = drawHelper._scene.camera.pickEllipsoid(movement.endPosition, ellipsoid);\r\n                    if (cartesian) {\r\n                        onDrag(cartesian);\r\n                    } else {\r\n                        onDragEnd(cartesian);\r\n                    }\r\n                }, Cesium.ScreenSpaceEventType.MOUSE_MOVE);\r\n\r\n                handler.setInputAction(function (movement) {\r\n                    onDragEnd(drawHelper._scene.camera.pickEllipsoid(movement.position, ellipsoid));\r\n                }, Cesium.ScreenSpaceEventType.LEFT_UP);\r\n\r\n                enableRotation(false);\r\n\r\n            });\r\n\r\n            enhanceWithListeners(billboard);\r\n\r\n        }\r\n\r\n        Cesium.Entity.prototype.setEditable = function (editable) {\r\n            if(editable ===  false){\r\n                var billboard = this;\r\n                removeListener(billboard,'leftDown');\r\n                this._editable = false;\r\n                return;\r\n            }\r\n\r\n            if (this.modeType !== 'billboard' || this._editable) {\r\n                return;\r\n            }\r\n\r\n            this._editable = true;\r\n\r\n            var billboard = this;\r\n\r\n            var _self = this;\r\n\r\n            function enableRotation(enable) {\r\n                drawHelper._scene.screenSpaceCameraController.enableRotate = enable;\r\n            }\r\n\r\n            setListener(billboard, 'leftDown', function (position) {\r\n                // TODO - start the drag handlers here\r\n                // create handlers for mouseOut and leftUp for the billboard and a mouseMove\r\n                function onDrag(position) {\r\n                    billboard.position = position;\r\n                    _self.executeListeners({name: 'drag', positions: position});\r\n                }\r\n\r\n                function onDragEnd(position) {\r\n                    handler.destroy();\r\n                    enableRotation(true);\r\n                    _self.executeListeners({name: 'dragEnd', positions: position});\r\n                }\r\n\r\n                var handler = new Cesium.ScreenSpaceEventHandler(drawHelper._scene.canvas);\r\n\r\n                handler.setInputAction(function (movement) {\r\n                    var cartesian = drawHelper._scene.camera.pickEllipsoid(movement.endPosition, ellipsoid);\r\n                    if (cartesian) {\r\n                        onDrag(cartesian);\r\n                    } else {\r\n                        onDragEnd(cartesian);\r\n                    }\r\n                }, Cesium.ScreenSpaceEventType.MOUSE_MOVE);\r\n\r\n                handler.setInputAction(function (movement) {\r\n                    onDragEnd(drawHelper._scene.camera.pickEllipsoid(movement.position, ellipsoid));\r\n                }, Cesium.ScreenSpaceEventType.LEFT_UP);\r\n\r\n                enableRotation(false);\r\n\r\n            });\r\n\r\n            enhanceWithListeners(billboard);\r\n        }\r\n\r\n        function setHighlighted(highlighted) {\r\n\r\n            var scene = drawHelper._scene;\r\n\r\n            // if no change\r\n            // if already highlighted, the outline polygon will be available\r\n            if (this._highlighted && this._highlighted == highlighted) {\r\n                return;\r\n            }\r\n            // disable if already in edit mode\r\n            if (this._editMode === true) {\r\n                return;\r\n            }\r\n            this._highlighted = highlighted;\r\n            // highlight by creating an outline polygon matching the polygon points\r\n            if (highlighted) {\r\n                // make sure all other shapes are not highlighted\r\n                drawHelper.setHighlighted(this);\r\n                this._strokeColor = this.strokeColor;\r\n                this.setStrokeStyle(Cesium.Color.fromCssColorString('white'), this.strokeWidth);\r\n            } else {\r\n                if (this._strokeColor) {\r\n                    this.setStrokeStyle(this._strokeColor, this.strokeWidth);\r\n                } else {\r\n                    this.setStrokeStyle(undefined, undefined);\r\n                }\r\n            }\r\n        }\r\n\r\n        function setEditMode(editMode) {\r\n            // if no change\r\n            if (this._editMode == editMode) {\r\n                return;\r\n            }\r\n            // make sure all other shapes are not in edit mode before starting the editing of this shape\r\n            drawHelper.disableAllHighlights();\r\n            // display markers\r\n            if (editMode) {\r\n                drawHelper.setEdited(this);\r\n                var scene = drawHelper._scene;\r\n                var _self = this;\r\n                // create the markers and handlers for the editing\r\n                if (this._markers == null) {\r\n                    var thisDragBillboard = this.dragBillboard? this.dragBillboard: dragBillboard;\r\n                    var thisDragHalfBillboard = this.dragHalfBillboard? this.dragHalfBillboard: dragBillboard;\r\n                    var markers = new _.BillboardGroup(drawHelper, thisDragBillboard);\r\n                    var editMarkers = new _.BillboardGroup(drawHelper, thisDragHalfBillboard);\r\n\r\n                    // function for updating the edit markers around a certain point\r\n                    function updateHalfMarkers(index, positions) {\r\n                        // update the half markers before and after the index\r\n                        var editIndex = index - 1 < 0 ? positions.length - 1 : index - 1;\r\n                        if (editIndex < editMarkers.countBillboards()) {\r\n                            editMarkers.getBillboard(editIndex).position = calculateHalfMarkerPosition(editIndex);\r\n                        }\r\n                        editIndex = index;\r\n                        if (editIndex < editMarkers.countBillboards()) {\r\n                            editMarkers.getBillboard(editIndex).position = calculateHalfMarkerPosition(editIndex);\r\n                        }\r\n                    }\r\n\r\n                    function onEdited() {\r\n                        _self.executeListeners({name: 'onEdited', positions: _self.positions});\r\n                    }\r\n\r\n                    var handleMarkerChanges = {\r\n                        dragHandlers: {\r\n                            onDrag: function (index, position) {\r\n                                _self.positions[index] = position;\r\n                                updateHalfMarkers(index, _self.positions);\r\n                                _self._createPrimitive = true;\r\n                            },\r\n                            onDragEnd: function (index, position) {\r\n                                _self._createPrimitive = true;\r\n                                onEdited();\r\n                            }\r\n                        },\r\n                        onDoubleClick: function (index) {\r\n                            if (_self.positions.length < 4) {\r\n                                return;\r\n                            }\r\n                            // remove the point and the corresponding markers\r\n                            _self.positions.splice(index, 1);\r\n                            _self._createPrimitive = true;\r\n                            markers.removeBillboard(index);\r\n                            editMarkers.removeBillboard(index);\r\n                            updateHalfMarkers(index, _self.positions);\r\n                            onEdited();\r\n                        },\r\n                        tooltip: function () {\r\n                            if (_self.positions.length > 3) {\r\n                                return \"Double click to remove this point\";\r\n                            }\r\n                        }\r\n                    };\r\n                    // add billboards and keep an ordered list of them for the polygon edges\r\n                    markers.addBillboards(_self.positions, handleMarkerChanges);\r\n                    this._markers = markers;\r\n\r\n                    function calculateHalfMarkerPosition(index) {\r\n                        var positions = _self.positions;\r\n                        return ellipsoid.cartographicToCartesian(\r\n                            new Cesium.EllipsoidGeodesic(ellipsoid.cartesianToCartographic(positions[index]),\r\n                                ellipsoid.cartesianToCartographic(positions[index < positions.length - 1 ? index + 1 : 0])).interpolateUsingFraction(0.5)\r\n                        );\r\n                    }\r\n\r\n                    var halfPositions = [];\r\n                    var index = 0;\r\n                    var length = _self.positions.length + (this.isPolygon ? 0 : -1);\r\n                    for (; index < length; index++) {\r\n                        halfPositions.push(calculateHalfMarkerPosition(index));\r\n                    }\r\n                    var handleEditMarkerChanges = {\r\n                        dragHandlers: {\r\n                            onDragStart: function (index, position) {\r\n                                // add a new position to the polygon but not a new marker yet\r\n                                this.index = index + 1;\r\n                                _self.positions.splice(this.index, 0, position);\r\n                                _self._createPrimitive = true;\r\n                            },\r\n                            onDrag: function (index, position) {\r\n                                _self.positions[this.index] = position;\r\n                                _self._createPrimitive = true;\r\n                            },\r\n                            onDragEnd: function (index, position) {\r\n                                // create new sets of makers for editing\r\n                                markers.insertBillboard(this.index, position, handleMarkerChanges);\r\n                                editMarkers.getBillboard(this.index - 1).position = calculateHalfMarkerPosition(this.index - 1);\r\n                                editMarkers.insertBillboard(this.index, calculateHalfMarkerPosition(this.index), handleEditMarkerChanges);\r\n                                _self._createPrimitive = true;\r\n                                onEdited();\r\n                            }\r\n                        },\r\n                        tooltip: function () {\r\n                            return \"Drag to create a new point\";\r\n                        }\r\n                    };\r\n                    editMarkers.addBillboards(halfPositions, handleEditMarkerChanges);\r\n                    this._editMarkers = editMarkers;\r\n                    // add a handler for clicking in the globe\r\n                    this._globeClickhandler = new Cesium.ScreenSpaceEventHandler(scene.canvas);\r\n                    this._globeClickhandler.setInputAction(\r\n                        function (movement) {\r\n                            var pickedObject = scene.pick(movement.position);\r\n                            if (!(pickedObject && pickedObject.primitive)) {\r\n                                _self.setEditMode(false);\r\n                            }\r\n                        }, Cesium.ScreenSpaceEventType.LEFT_CLICK);\r\n\r\n                    // set on top of the polygon\r\n                    markers.setOnTop();\r\n                    editMarkers.setOnTop();\r\n                }\r\n                this._editMode = true;\r\n            } else {\r\n                if (this._markers != null) {\r\n                    this._markers.remove();\r\n                    this._editMarkers.remove();\r\n                    this._markers = null;\r\n                    this._editMarkers = null;\r\n                    this._globeClickhandler.destroy();\r\n                }\r\n                this._editMode = false;\r\n            }\r\n\r\n        }\r\n\r\n        _.PolylinePrimitive.prototype.setEditable = function () {\r\n\r\n            if (this.setEditMode) {\r\n                return;\r\n            }\r\n\r\n            var polyline = this;\r\n            polyline.isPolygon = false;\r\n            polyline.asynchronous = false;\r\n\r\n            drawHelper.registerEditableShape(polyline);\r\n\r\n            polyline.setEditMode = setEditMode;\r\n\r\n            var originalWidth = this.width;\r\n\r\n            polyline.setHighlighted = function (highlighted) {\r\n                // disable if already in edit mode\r\n                if (this._editMode === true) {\r\n                    return;\r\n                }\r\n                if (highlighted) {\r\n                    drawHelper.setHighlighted(this);\r\n                    this.setWidth(originalWidth * 2);\r\n                } else {\r\n                    this.setWidth(originalWidth);\r\n                }\r\n            }\r\n\r\n            polyline.getExtent = function () {\r\n                return Cesium.Extent.fromCartographicArray(ellipsoid.cartesianArrayToCartographicArray(this.positions));\r\n            }\r\n\r\n            enhanceWithListeners(polyline);\r\n\r\n            polyline.setEditMode(false);\r\n\r\n        }\r\n\r\n        _.PolygonPrimitive.prototype.setEditable = function () {\r\n\r\n            var polygon = this;\r\n            polygon.asynchronous = false;\r\n\r\n            var scene = drawHelper._scene;\r\n\r\n            drawHelper.registerEditableShape(polygon);\r\n\r\n            polygon.setEditMode = setEditMode;\r\n\r\n            polygon.setHighlighted = setHighlighted;\r\n\r\n            enhanceWithListeners(polygon);\r\n\r\n            polygon.setEditMode(false);\r\n\r\n        }\r\n\r\n        _.ExtentPrimitive.prototype.setEditable = function () {\r\n\r\n            if (this.setEditMode) {\r\n                return;\r\n            }\r\n\r\n            var extent = this;\r\n            var scene = drawHelper._scene;\r\n\r\n            drawHelper.registerEditableShape(extent);\r\n            extent.asynchronous = false;\r\n\r\n            extent.setEditMode = function (editMode) {\r\n                // if no change\r\n                if (this._editMode == editMode) {\r\n                    return;\r\n                }\r\n                drawHelper.disableAllHighlights();\r\n                // display markers\r\n                if (editMode) {\r\n                    // make sure all other shapes are not in edit mode before starting the editing of this shape\r\n                    drawHelper.setEdited(this);\r\n                    // create the markers and handlers for the editing\r\n                    if (this._markers == null) {\r\n                        var thisDragBillboard = this.dragBillboard? this.dragBillboard: dragBillboard;\r\n                        var thisDragHalfBillboard = this.dragHalfBillboard? this.dragHalfBillboard: dragBillboard;\r\n\r\n                        var markers = new _.BillboardGroup(thisDragBillboard,thisDragHalfBillboard);\r\n\r\n                        function onEdited() {\r\n                            extent.executeListeners({name: 'onEdited', extent: extent.extent});\r\n                        }\r\n\r\n                        var handleMarkerChanges = {\r\n                            dragHandlers: {\r\n                                onDrag: function (index, position) {\r\n                                    var corner = markers.getBillboard((index + 2) % 4).position;\r\n                                    extent.setExtent(getExtent(ellipsoid.cartesianToCartographic(corner), ellipsoid.cartesianToCartographic(position)));\r\n                                    markers.updateBillboardsPositions(getExtentCorners(extent.extent));\r\n                                },\r\n                                onDragEnd: function (index, position) {\r\n                                    onEdited();\r\n                                }\r\n                            },\r\n                            tooltip: function () {\r\n                                return \"Drag to change the corners of this extent\";\r\n                            }\r\n                        };\r\n                        markers.addBillboards(getExtentCorners(extent.extent), handleMarkerChanges);\r\n                        this._markers = markers;\r\n                        // add a handler for clicking in the globe\r\n                        this._globeClickhandler = new Cesium.ScreenSpaceEventHandler(scene.canvas);\r\n                        this._globeClickhandler.setInputAction(\r\n                            function (movement) {\r\n                                var pickedObject = scene.pick(movement.position);\r\n                                // disable edit if pickedobject is different or not an object\r\n                                try {\r\n                                    if (!(pickedObject && !pickedObject.isDestroyed() && pickedObject.primitive)) {\r\n                                        extent.setEditMode(false);\r\n                                    }\r\n                                } catch (e) {\r\n                                    extent.setEditMode(false);\r\n                                }\r\n                            }, Cesium.ScreenSpaceEventType.LEFT_CLICK);\r\n\r\n                        // set on top of the polygon\r\n                        markers.setOnTop();\r\n                    }\r\n                    this._editMode = true;\r\n                } else {\r\n                    if (this._markers != null) {\r\n                        this._markers.remove();\r\n                        this._markers = null;\r\n                        this._globeClickhandler.destroy();\r\n                    }\r\n                    this._editMode = false;\r\n                }\r\n            }\r\n\r\n            extent.setHighlighted = setHighlighted;\r\n\r\n            enhanceWithListeners(extent);\r\n\r\n            extent.setEditMode(false);\r\n\r\n        }\r\n\r\n        _.EllipsePrimitive.prototype.setEditable = function () {\r\n\r\n            if (this.setEditMode) {\r\n                return;\r\n            }\r\n\r\n            var ellipse = this;\r\n            var scene = drawHelper._scene;\r\n\r\n            ellipse.asynchronous = false;\r\n\r\n            drawHelper.registerEditableShape(ellipse);\r\n\r\n            ellipse.setEditMode = function (editMode) {\r\n                // if no change\r\n                if (this._editMode == editMode) {\r\n                    return;\r\n                }\r\n                drawHelper.disableAllHighlights();\r\n                // display markers\r\n                if (editMode) {\r\n                    // make sure all other shapes are not in edit mode before starting the editing of this shape\r\n                    drawHelper.setEdited(this);\r\n                    var _self = this;\r\n                    // create the markers and handlers for the editing\r\n                    if (this._markers == null) {\r\n                        var thisDragBillboard = this.dragBillboard? this.dragBillboard: dragBillboard;\r\n\r\n                        var markers = new _.BillboardGroup(drawHelper,thisDragBillboard );\r\n\r\n                        function getMarkerPositions() {\r\n                            return Cesium.Shapes.computeEllipseBoundary(ellipsoid, ellipse.getCenter(), ellipse.getSemiMajorAxis(), ellipse.getSemiMinorAxis(), ellipse.getRotation() + Math.PI / 2, Math.PI / 2.0).splice(0, 4);\r\n                        }\r\n\r\n                        function onEdited() {\r\n                            ellipse.executeListeners({\r\n                                name: 'onEdited',\r\n                                center: ellipse.getCenter(),\r\n                                semiMajorAxis: ellipse.getSemiMajorAxis(),\r\n                                semiMinorAxis: ellipse.getSemiMinorAxis(),\r\n                                rotation: 0\r\n                            });\r\n                        }\r\n\r\n                        var handleMarkerChanges = {\r\n                            dragHandlers: {\r\n                                onDrag: function (index, position) {\r\n                                    var distance = Cesium.Cartesian3.distance(ellipse.getCenter(), position);\r\n                                    if (index % 2 == 0) {\r\n                                        ellipse.setSemiMajorAxis(distance);\r\n                                    } else {\r\n                                        ellipse.setSemiMinorAxis(distance);\r\n                                    }\r\n                                    markers.updateBillboardsPositions(getMarkerPositions());\r\n                                },\r\n                                onDragEnd: function (index, position) {\r\n                                    onEdited();\r\n                                }\r\n                            },\r\n                            tooltip: function () {\r\n                                return \"Drag to change the excentricity and radius\";\r\n                            }\r\n                        };\r\n                        markers.addBillboards(getMarkerPositions(), handleMarkerChanges);\r\n                        this._markers = markers;\r\n                        // add a handler for clicking in the globe\r\n                        this._globeClickhandler = new Cesium.ScreenSpaceEventHandler(scene.canvas);\r\n                        this._globeClickhandler.setInputAction(\r\n                            function (movement) {\r\n                                var pickedObject = scene.pick(movement.position);\r\n                                if (!(pickedObject && pickedObject.primitive)) {\r\n                                    _self.setEditMode(false);\r\n                                }\r\n                            }, Cesium.ScreenSpaceEventType.LEFT_CLICK);\r\n\r\n                        // set on top of the polygon\r\n                        markers.setOnTop();\r\n                    }\r\n                    this._editMode = true;\r\n                } else {\r\n                    if (this._markers != null) {\r\n                        this._markers.remove();\r\n                        this._markers = null;\r\n                        this._globeClickhandler.destroy();\r\n                    }\r\n                    this._editMode = false;\r\n                }\r\n            }\r\n\r\n            ellipse.setHighlighted = setHighlighted;\r\n\r\n            enhanceWithListeners(ellipse);\r\n\r\n            ellipse.setEditMode(false);\r\n        }\r\n\r\n        _.CirclePrimitive.prototype.getCircleCartesianCoordinates = function (granularity) {\r\n            var geometry = Cesium.CircleOutlineGeometry.createGeometry(new Cesium.CircleOutlineGeometry({\r\n                ellipsoid: ellipsoid,\r\n                center: this.getCenter(),\r\n                radius: this.getRadius(),\r\n                granularity: granularity\r\n            }));\r\n            var count = 0, value, values = [];\r\n            for (; count < geometry.attributes.position.values.length; count += 3) {\r\n                value = geometry.attributes.position.values;\r\n                values.push(new Cesium.Cartesian3(value[count], value[count + 1], value[count + 2]));\r\n            }\r\n            return values;\r\n        };\r\n\r\n        _.CirclePrimitive.prototype.setEditable = function () {\r\n\r\n            if (this.setEditMode) {\r\n                return;\r\n            }\r\n\r\n            var circle = this;\r\n            var scene = drawHelper._scene;\r\n\r\n            circle.asynchronous = false;\r\n\r\n            drawHelper.registerEditableShape(circle);\r\n\r\n            circle.setEditMode = function (editMode) {\r\n                // if no change\r\n                if (this._editMode == editMode) {\r\n                    return;\r\n                }\r\n                drawHelper.disableAllHighlights();\r\n                // display markers\r\n                if (editMode) {\r\n                    // make sure all other shapes are not in edit mode before starting the editing of this shape\r\n                    drawHelper.setEdited(this);\r\n                    var _self = this;\r\n                    // create the markers and handlers for the editing\r\n                    if (this._markers == null) {\r\n                        var thisDragBillboard = this.dragBillboard? this.dragBillboard: dragBillboard;\r\n\r\n                        var markers = new _.BillboardGroup(drawHelper, thisDragBillboard);\r\n\r\n                        function getMarkerPositions() {\r\n                            // return _self.getCircleCartesianCoordinates(Cesium.Math.PI_OVER_TWO);\r\n                            return _self.getCircleCartesianCoordinates(Cesium.Math.PI_OVER_TWO);\r\n                        }\r\n\r\n                        function onEdited() {\r\n                            circle.executeListeners({\r\n                                name: 'onEdited',\r\n                                center: circle.getCenter(),\r\n                                radius: circle.getRadius()\r\n                            });\r\n                        }\r\n\r\n                        var handleMarkerChanges = {\r\n                            dragHandlers: {\r\n                                onDrag: function (index, position) {\r\n                                    circle.setRadius(Cesium.Cartesian3.distance(circle.getCenter(), position));\r\n                                    markers.updateBillboardsPositions(getMarkerPositions());\r\n                                },\r\n                                onDragEnd: function (index, position) {\r\n                                    onEdited();\r\n                                }\r\n                            },\r\n                            tooltip: function () {\r\n                                return \"Drag to change the radius\";\r\n                            }\r\n                        };\r\n                        markers.addBillboards(getMarkerPositions(), handleMarkerChanges);\r\n                        this._markers = markers;\r\n                        // add a handler for clicking in the globe\r\n                        this._globeClickhandler = new Cesium.ScreenSpaceEventHandler(scene.canvas);\r\n                        this._globeClickhandler.setInputAction(\r\n                            function (movement) {\r\n                                var pickedObject = scene.pick(movement.position);\r\n                                if (!(pickedObject && pickedObject.primitive)) {\r\n                                    _self.setEditMode(false);\r\n                                }\r\n                            }, Cesium.ScreenSpaceEventType.LEFT_CLICK);\r\n\r\n                        // set on top of the polygon\r\n                        markers.setOnTop();\r\n                    }\r\n                    this._editMode = true;\r\n                } else {\r\n                    if (this._markers != null) {\r\n                        this._markers.remove();\r\n                        this._markers = null;\r\n                        this._globeClickhandler.destroy();\r\n                    }\r\n                    this._editMode = false;\r\n                }\r\n            }\r\n\r\n            circle.setHighlighted = setHighlighted;\r\n\r\n            enhanceWithListeners(circle);\r\n\r\n            circle.setEditMode(false);\r\n        }\r\n\r\n    }\r\n\r\n    _.DrawHelperWidget = (function () {\r\n\r\n        // constructor\r\n        function _(drawHelper, options) {\r\n\r\n            // container must be specified\r\n            if (!(Cesium.defined(options.container))) {\r\n                throw new Cesium.DeveloperError('Container is required');\r\n            }\r\n\r\n            var drawOptions = {\r\n                // markerIcon: \"./img/glyphicons_242_google_maps.png\",\r\n                // polylineIcon: \"./img/glyphicons_097_vector_path_line.png\",\r\n                // polygonIcon: \"./img/glyphicons_096_vector_path_polygon.png\",\r\n                // circleIcon: \"./img/glyphicons_095_vector_path_circle.png\",\r\n                // extentIcon: \"./img/glyphicons_094_vector_path_square.png\",\r\n                // clearIcon: \"./img/glyphicons_067_cleaning.png\",\r\n                markerIcon: \" marker\",\r\n                polylineIcon: \" polyline\",\r\n                polygonIcon: \" polygon\",\r\n                circleIcon: \" circle\",\r\n                extentIcon: \" extent\",\r\n                clearIcon: \" clear\",\r\n                polylineDrawingOptions: defaultPolylineOptions,\r\n                polygonDrawingOptions: defaultPolygonOptions,\r\n                extentDrawingOptions: defaultExtentOptions,\r\n                circleDrawingOptions: defaultCircleOptions,\r\n                strategy: {\r\n                    pickStrategy: options.pickStrategy ? options.pickStrategy : defaultPickStrategy\r\n                }\r\n            };\r\n\r\n            fillOptions(options, drawOptions);\r\n\r\n            var _self = this;\r\n\r\n            var toolbar = document.createElement('DIV');\r\n            toolbar.className = \"toolbar\";\r\n            options.container.appendChild(toolbar);\r\n\r\n            function addIcon(id, url, title, callback) {\r\n                var div = document.createElement('DIV');\r\n                div.className = 'button' + url;\r\n                div.title = title;\r\n                toolbar.appendChild(div);\r\n                div.onclick = callback;\r\n                // var span = document.createElement('SPAN');\r\n                // div.appendChild(span);\r\n                // var image = document.createElement('IMG');\r\n                // image.src = url;\r\n                // span.appendChild(image);\r\n                return div;\r\n            }\r\n\r\n            var scene = drawHelper._scene;\r\n            // console.log(options.buttons)\r\n\r\n            options.buttons.indexOf(\"marker\") !== -1 && addIcon('marker', options.markerIcon, 'Click to start drawing a 2D marker', function () {\r\n                typeof options.clickCallback === 'function' &&\r\n                options.clickCallback({\r\n                    name: 'markerClick'\r\n                });\r\n\r\n                drawHelper.startDrawingMarker({\r\n                    callback: function (position) {\r\n                        _self.executeListeners({name: 'markerCreated', position: position});\r\n                    },\r\n                    strategy: options.strategy\r\n                });\r\n            })\r\n\r\n            options.buttons.indexOf(\"polyline\") !== -1 && addIcon('polyline', options.polylineIcon, 'Click to start drawing a 2D polyline', function () {\r\n                typeof options.clickCallback === 'function' &&\r\n                options.clickCallback({\r\n                    name: 'polylineClick'\r\n                });\r\n\r\n                drawHelper.startDrawingPolyline({\r\n                    callback: function (positions) {\r\n                        _self.executeListeners({name: 'polylineCreated', positions: positions});\r\n                    },\r\n                    strategy: options.strategy\r\n                });\r\n            })\r\n\r\n            options.buttons.indexOf(\"polygon\") !== -1 && addIcon('polygon', options.polygonIcon, 'Click to start drawing a 2D polygon', function () {\r\n                typeof options.clickCallback === 'function' &&\r\n                options.clickCallback({\r\n                    name: 'polygonClick'\r\n                });\r\n\r\n                drawHelper.startDrawingPolygon({\r\n                    callback: function (positions) {\r\n                        _self.executeListeners({name: 'polygonCreated', positions: positions});\r\n                    },\r\n                    strategy: options.strategy\r\n                });\r\n            })\r\n\r\n            options.buttons.indexOf(\"extent\") !== -1 && addIcon('extent', options.extentIcon, 'Click to start drawing an Extent', function () {\r\n                typeof options.clickCallback === 'function' &&\r\n                options.clickCallback({\r\n                    name: 'extentClick'\r\n                });\r\n\r\n                drawHelper.startDrawingExtent({\r\n                    callback: function (extent) {\r\n                        _self.executeListeners({name: 'extentCreated', extent: extent});\r\n                    },\r\n                    strategy: options.strategy\r\n                });\r\n            })\r\n\r\n            options.buttons.indexOf(\"circle\") !== -1 && addIcon('circle', options.circleIcon, 'Click to start drawing a Circle', function () {\r\n                typeof options.clickCallback === 'function' &&\r\n                options.clickCallback({\r\n                    name: 'circleClick'\r\n                });\r\n\r\n                drawHelper.startDrawingCircle({\r\n                    callback: function (center, radius) {\r\n                        _self.executeListeners({name: 'circleCreated', center: center, radius: radius});\r\n                    },\r\n                    strategy: options.strategy\r\n                });\r\n            })\r\n\r\n            // add a clear button at the end\r\n            // add a divider first\r\n            var div = document.createElement('DIV');\r\n            div.className = 'divider';\r\n            toolbar.appendChild(div);\r\n\r\n            options.buttons.indexOf(\"clear\") !== -1 &&\r\n            addIcon('clear', options.clearIcon, 'Remove all primitives', function () {\r\n                typeof options.clickCallback === 'function' &&\r\n                options.clickCallback({\r\n                    name: 'clearClick'\r\n                });\r\n\r\n                scene.primitives.removeAll();\r\n            });\r\n\r\n            enhanceWithListeners(this);\r\n\r\n        }\r\n\r\n\r\n        return _;\r\n\r\n    })();\r\n\r\n    /**\r\n     * 新增工具栏点击回调\r\n     * @param container\r\n     * @param options\r\n     * @param {function(event)} options.clickCallback - event.name包括${toolbarName}Click\r\n     * @returns {_|*}\r\n     */\r\n    _.prototype.addToolbar = function (container, options) {\r\n        options = copyOptions(options, {container: container});\r\n        return new _.DrawHelperWidget(this, options);\r\n    }\r\n\r\n    function getExtent(mn, mx) {\r\n        var e = new Cesium.Rectangle();\r\n\r\n        // Re-order so west < east and south < north\r\n        e.west = Math.min(mn.longitude, mx.longitude);\r\n        e.east = Math.max(mn.longitude, mx.longitude);\r\n        e.south = Math.min(mn.latitude, mx.latitude);\r\n        e.north = Math.max(mn.latitude, mx.latitude);\r\n\r\n        // Check for approx equal (shouldn't require abs due to re-order)\r\n        var epsilon = Cesium.Math.EPSILON7;\r\n\r\n        if ((e.east - e.west) < epsilon) {\r\n            e.east += epsilon * 2.0;\r\n        }\r\n\r\n        if ((e.north - e.south) < epsilon) {\r\n            e.north += epsilon * 2.0;\r\n        }\r\n\r\n        return e;\r\n    };\r\n\r\n    function createTooltip(frameDiv) {\r\n\r\n        var tooltip = function (frameDiv) {\r\n\r\n            var div = document.createElement('DIV');\r\n            div.className = \"twipsy right\";\r\n\r\n            var arrow = document.createElement('DIV');\r\n            arrow.className = \"twipsy-arrow\";\r\n            div.appendChild(arrow);\r\n\r\n            var title = document.createElement('DIV');\r\n            title.className = \"twipsy-inner\";\r\n\r\n            div.appendChild(title);\r\n\r\n            this._div = div;\r\n            this._title = title;\r\n\r\n            // add to frame div and display coordinates\r\n            frameDiv.appendChild(div);\r\n            this.addEvent();\r\n            this.setVisible(false);\r\n        }\r\n\r\n        tooltip.prototype.setVisible = function (visible) {\r\n            this._div.style.display = visible ? 'block' : 'none';\r\n        }\r\n\r\n        tooltip.prototype.showAt = function (position, message) {\r\n            if (position && message) {\r\n                this.setVisible(true);\r\n                this._title.innerHTML = message;\r\n                // this._div.style.left = position.x + 10 + \"px\";\r\n                // this._div.style.top = (position.y - this._div.clientHeight / 2) + \"px\";\r\n            }\r\n        }\r\n\r\n        tooltip.prototype.show = function (message) {\r\n            if (message) {\r\n                this.setVisible(true);\r\n                this._title.innerHTML = message;\r\n            }\r\n        }\r\n\r\n        /**\r\n         * 解决拖动到tip上时宕机的问题\r\n         */\r\n        tooltip.prototype.addEvent = function () {\r\n            var me = this;\r\n            var count = 0;\r\n            document.body.addEventListener(\"mousemove\", function (ev) {\r\n                if (me._div.style.display === 'block' && (count = ((count++) % 3)) === 0) {\r\n                    me._div.style.left = ev.offsetX + 20 + \"px\";\r\n                    me._div.style.top = (ev.offsetY - me._div.clientHeight / 2) + \"px\";\r\n                }\r\n            })\r\n        }\r\n\r\n        return new tooltip(frameDiv);\r\n    }\r\n\r\n    function getDisplayLatLngString(cartographic, precision) {\r\n        return cartographic.longitude.toFixed(precision || 3) + \", \" + cartographic.latitude.toFixed(precision || 3);\r\n    }\r\n\r\n    function clone(from, to) {\r\n        if (from == null || typeof from != \"object\") return from;\r\n        if (from.constructor != Object && from.constructor != Array) return from;\r\n        if (from.constructor == Date || from.constructor == RegExp || from.constructor == Function ||\r\n            from.constructor == String || from.constructor == Number || from.constructor == Boolean)\r\n            return new from.constructor(from);\r\n\r\n        to = to || new from.constructor();\r\n\r\n        for (var name in from) {\r\n            to[name] = typeof to[name] == \"undefined\" ? clone(from[name], null) : to[name];\r\n        }\r\n\r\n        return to;\r\n    }\r\n\r\n    function fillOptions(options, defaultOptions) {\r\n        options = options || {};\r\n        var option;\r\n        for (option in defaultOptions) {\r\n            if (options[option] === undefined) {\r\n                options[option] = clone(defaultOptions[option]);\r\n            }\r\n        }\r\n    }\r\n\r\n    // shallow copy\r\n    function copyOptions(options, defaultOptions) {\r\n        var newOptions = clone(options), option;\r\n        for (option in defaultOptions) {\r\n            if (newOptions[option] === undefined) {\r\n                newOptions[option] = clone(defaultOptions[option]);\r\n            }\r\n        }\r\n        return newOptions;\r\n    }\r\n\r\n    function extendOptions(options, defaultOptions) {\r\n        var newOptions = clone(options), option;\r\n        for (option in defaultOptions) {\r\n            newOptions[option] = clone(defaultOptions[option]);\r\n        }\r\n        return newOptions;\r\n    }\r\n\r\n    function setListener(primitive, type, callback) {\r\n        primitive[type] = callback;\r\n    }\r\n\r\n    function removeListener(primitive, type) {\r\n        delete primitive[type];\r\n    }\r\n\r\n    function enhanceWithListeners(element) {\r\n\r\n        element._listeners = {};\r\n\r\n        element.addListener = function (name, callback) {\r\n            this._listeners[name] = (this._listeners[name] || []);\r\n            this._listeners[name].push(callback);\r\n            return this._listeners[name].length;\r\n        }\r\n\r\n        element.executeListeners = function (event, defaultCallback) {\r\n            if (this._listeners[event.name] && this._listeners[event.name].length > 0) {\r\n                var index = 0;\r\n                for (; index < this._listeners[event.name].length; index++) {\r\n                    this._listeners[event.name][index](event);\r\n                }\r\n            } else {\r\n                if (defaultCallback) {\r\n                    defaultCallback(event);\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * 获取当前点位的近地点位\r\n     * @param {Cesium.Cartesian3} cesium3\r\n     * @returns {Cesium.Cartesian3}\r\n     */\r\n    function getCesiumHightZero(cesium3) {\r\n        var fromCartesian = Cesium.Cartographic.fromCartesian(cesium3);\r\n        return Cesium.Cartesian3.fromRadians(fromCartesian.longitude, fromCartesian.latitude, 0);\r\n    }\r\n\r\n\r\n    return _;\r\n}));","module.exports = function(module) {\r\n\tif (!module.webpackPolyfill) {\r\n\t\tmodule.deprecate = function() {};\r\n\t\tmodule.paths = [];\r\n\t\t// module.parent = undefined by default\r\n\t\tif (!module.children) module.children = [];\r\n\t\tObject.defineProperty(module, \"loaded\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.l;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"id\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.i;\r\n\t\t\t}\r\n\t\t});\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n};\r\n"],"sourceRoot":""}